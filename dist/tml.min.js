/*! tml-js-browser 08-12-2015 */
!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){var d=a("tml-js"),e=function(){};e.prototype=d.utils.extend(new d.ApiAdapterBase,{get:function(a,b,c){this.request("get",a,b,c)},post:function(a,b,c){this.request("post",a,b,c)},request:function(a,b,c,e){var f=new Date;e||(e=function(){});var g,h=new XMLHttpRequest;if(a.match(/^get$/i)?(b=b+"?"+this.serialize(c||{}),g=null):g=this.serialize(c||{}),d.logger.debug("get "+b),"withCredentials"in h)h.open(a,b,!0);else{if("undefined"==typeof XDomainRequest)return!1;h=new XDomainRequest,h.open(a,b)}h.setRequestHeader("Content-type","application/x-www-form-urlencoded"),h.onload=function(){var a=new Date;d.logger.debug("call took "+(a-f)+" mls"),e(null,h,h.responseText)},h.onerror=function(a){e(a,h)},h.send(g)},serialize:function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")}}),b.exports=e},{"tml-js":30}],2:[function(a,b,c){var d=a("tml-js"),e=function(a){this.initialize(a)};e.prototype=d.utils.extend(new d.CacheAdapterBase,{name:"browser",read_only:!1,create:function(){return window.localStorage},fetchFromPath:function(a,b,c){if("current_version"==a)return void this.fetchDefault(a,b,c);var d=this.config.path+"/"+this.config.version+"/"+a+".json",e=this;e.getRequest().get(d,{},function(d,f,g){d||200!=f.status||null===g?e.fetchDefault(a,b,c):e.store(a,g,function(){c(null,g)})})},fetch:function(a,b,c){var d=this.cache.getItem(this.getVersionedKey(a));d?(this.info("cache hit "+a),c(null,d)):(this.info("cache miss "+a),this.config.path?this.fetchFromPath(a,b,c):this.fetchDefault(a,b,c))},getRequest:function(){return this.ajax||(this.ajax=new d.config.getApiAdapter("ajax")),this.ajax},store:function(a,b,c){var d=this.getVersionedKey(a);this.info("cache store "+a),this.cache.setItem(d,this.stripExtensions(b)),c&&c(null,b)},del:function(a,b){this.info("cache del "+a),this.cache.removeItem(this.getVersionedKey(a)),b&&b(null)},exists:function(a,b){var c=this.cache.getItem(this.getVersionedKey(a));b&&b(!!c)},clear:function(a){for(var b in this.cache)b.match(/^tml_/)&&this.cache.removeItem(b);a&&a(null)}}),b.exports=e},{"tml-js":30}],3:[function(a,b,c){var d=a("tml-js"),e=function(a){this.initialize(a)};e.prototype=d.utils.extend(new d.CacheAdapterBase,{name:"inline",read_only:!0,cache:{},create:function(){return window[this.config.name]||{}},fetch:function(a,b,c){var e=a.split("/"),f=this.cache;return e.forEach(function(a){d.utils.isObject(f)&&(f=f[a])}),f?(this.info("cache hit "+a),f=JSON.stringify(f),void(c&&c(null,f))):(this.info("cache miss "+a),d.utils.isFunction(b)?void b(function(a,b){c(a,b)}):(f=b||null,f&&(f=JSON.stringify(f)),void(c&&c(null,f))))},store:function(a,b,c){return this.info("the cache is readonly. can't store data"),b},del:function(a,b){this.info("the cache is readonly. can't delete data")},exists:function(a,b){b&&b(!!this.cache[a])}}),b.exports=e},{"tml-js":30}],4:[function(require,module,exports){var tml=require("tml-js"),utils=tml.utils,helpers={printWelcomeMessage:function(a){console.log([" _______                  _       _   _             ______          _","|__   __|                | |     | | (_)           |  ____|        | |","   | |_ __ __ _ _ __  ___| | __ _| |_ _  ___  _ __ | |__  __  _____| |__   __ _ _ __   __ _  ___","   | | '__/ _` | '_ \\/ __| |/ _` | __| |/ _ \\| '_ \\|  __| \\ \\/ / __| '_ \\ / _` | '_ \\ / _` |/ _ \\","   | | | | (_| | | | \\__ \\ | (_| | |_| | (_) | | | | |____ >  < (__| | | | (_| | | | | (_| |  __/","   |_|_|  \\__,_|_| |_|___/_|\\__,_|\\__|_|\\___/|_| |_|______/_/\\_\\___|_| |_|\\__,_|_| |_|\\__, |\\___|","                                                                                       __/ |","                                                                                      |___/","   version "+a,"","   We are hiring! http://translationexchange.com/jobs "," "].join("\n"))},getBrowserLanguages:function(){var a=window.navigator;return a.languages||a.language&&[a.language]||a.userLanguage&&[a.userLanguage]||a.browserLanguage&&[a.browserLanguage]||null},includeTools:function(app,locale,callback){utils.addCSS(window.document,app.tools.stylesheet,!1),utils.addCSS(window.document,app.css,!0),utils.addJS(window.document,"tml-jssdk",app.tools.javascript,function(){Tml.app_key=app.key,Tml.host=app.tools.host,Tml.current_source=app.current_source,Tml.default_locale=app.default_locale,Tml.page_locale=locale,Tml.locale=locale;var shortcutFn=function(sc){return function(){eval(app.shortcuts[sc])}};if(app.isFeatureEnabled("shortcuts"))for(var sc in app.shortcuts)shortcut.add(sc,shortcutFn(sc));callback&&callback()})},includeAgent:function(a,b,c){var d=b.host||"https://cdn.translationexchange.com/tools/agent/"+b.version+"/agent.min.js";utils.addJS(window.document,"tml-agent",d,function(){Trex.init(a.key,b),c&&Trex.ready(c)})},getCurrentSource:function(a){var b=null,c=a.current_source||a.source;if(c&&(b=utils.isFunction(c)?c():c),!b){var d=document.createElement("a");d.href=location.href,b=d.pathname}return b=b.replace(/^\//,""),b.match(/\/$/)&&(b+="index"),""===b&&(b="index"),b},getCurrentLocale:function(a,b){var c=null;if(b)c=utils.isFunction(b)?b():b;else if(c=(window.location.search.match(/[?&]locale=([^&]+)(&|$)/)||[])[1])this.updateCurrentLocale(a,c);else{var d=this.getCookie(a);c=d.locale}return c},updateCurrentLocale:function(a,b){var c=helpers.getCookie(a);c=c||{},c.locale=b,this.setCookie(a,c)},getCookie:function(a){for(var b=utils.getCookieName(a),c=b+"=",d=document.cookie.split(";"),e=0;e<d.length;e++){for(var f=d[e];" "==f.charAt(0);)f=f.substring(1);if(-1!=f.indexOf(c))return utils.decode(f.substring(c.length,f.length))}return{}},setCookie:function(a,b){var c=utils.getCookieName(a);document.cookie=c+"="+utils.encode(b)+"; path=/"}};module.exports={printWelcomeMessage:helpers.printWelcomeMessage,getBrowserLanguages:helpers.getBrowserLanguages,includeTools:helpers.includeTools,getCurrentSource:helpers.getCurrentSource,getCurrentLocale:helpers.getCurrentLocale,updateCurrentLocale:helpers.updateCurrentLocale,getCookie:helpers.getCookie,setCookie:helpers.setCookie,includeAgent:helpers.includeAgent}},{"tml-js":30}],5:[function(a,b,c){var d=a("tml-js"),e=a("./helpers"),f=a("./tokenizers/dom"),g="https://api.translationexchange.com",h=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;d=d.utils.extend(d,{version:"0.4.3",app:null,block_options:[],root_element:null,options:{},init:function(a,b){a=a||{},d.options=a,d.config.debug=a.debug?a.debug:d.config.debug,a.preferred_languages=a.preferred_languages||e.getBrowserLanguages(),(d.config.debug||a.info)&&e.printWelcomeMessage(d.version),d.initApplication(a,b)},initApplication:function(b,c){var f=new Date,i=e.getCookie(b.key),j=null;b.cache&&b.cache.version&&(j=b.cache.version),d.config.registerApiAdapter("ajax",a("./api_adapters/ajax")),d.config.api="ajax",d.config.registerCacheAdapters({inline:a("./cache_adapters/inline"),browser:a("./cache_adapters/browser")}),b=d.utils.merge(d.config,{delayed_flush:!0,api:"ajax",current_source:e.getCurrentSource(b),current_locale:e.getCurrentLocale(b.key,b.current_locale),current_translator:i.translator?new d.Translator(i.translator):null,accepted_locales:window.navigator.languages,cache:{enabled:!0,adapter:"browser",version:j}},b),b.fetch_version="browser"==b.cache.adapter&&!j,d.config.initCache(b.key),d.app=new d.Application({key:b.key,token:b.token,host:b.host||g}),d.app.init(b,function(a){if(a)throw new Error(a);(b.translateBody||b.translate_body)&&h&&d.translateElement(document),d.domReady(function(){!b.translateBody&&!b.translate_body||h||d.translateElement(document.body);var a=new Date;d.logger.debug("page render took "+(a-f)+" mls"),d.updateLanguageSelector(),(b.translateTitle||b.translate_title)&&""!==document.title&&(document.title=d.translateLabel(document.title)),b.agent||(b.agent={enabled:!0,version:"latest",type:"tools"}),b.agent.enabled?"agent"==b.agent.type?e.includeAgent(d.app,{host:b.agent.host,version:b.agent.version||"stable",domains:b.agent.domains||{},locale:b.current_locale,source:b.current_source},function(){c&&c()}):e.includeTools(d.app,b.current_locale,function(){c&&c()}):c&&c(),"function"==typeof b.onLoad&&b.onLoad(d.app)}),b.fetch_version&&setTimeout(function(){d.config.getCache().fetchVersion(function(a){d.app.getApiClient().getReleaseVersion(function(b){a!=b&&d.config.getCache().clear()})})},1e3)})},domReady:function(a){!document.readyState||/ded|te/.test(document.readyState)?a():document.addEventListener("DOMContentLoaded",a,!1)},updateLanguageSelector:function(){var a=document.querySelectorAll("[data-tml-language-selector], [tml-language-selector]");if(0!==a.length)for(var b=0;b<a.length;b++){var c=a[b].getAttribute("data-tml-language-selector");c=c||"popup";var e=a[b].getAttribute("data-tml-language-selector-element");e=e||"div";var f="true"==a[b].getAttribute("data-tml-toggle"),g=a[b].getAttribute("data-tml-toggle-label"),h="true"==a[b].getAttribute("data-tml-powered-by");a[b].innerHTML=d.getLanguageSelector(c,{element:e,container:a[b],toggle:f,toggle_label:g,powered_by:h}),d.scripts.language_selector_init(d.app,c)}},changeLanguage:function(a){d.app.changeLanguage(a,function(b){e.updateCurrentLocale(d.options.key,a),d.config.currentLanguage=d.app.getCurrentLanguage(),this.tokenizer&&this.tokenizer.updateAllNodes(),d.updateLanguageSelector(),d.utils.isFunction(d.options.onLanguageChange)&&d.options.onLanguageChange(b)}.bind(this))},translate:function(a,b,c,e){if(!d.app)throw new Error("Invalid application.");var f=d.utils.normalizeParams(a,b,c,e);return f.label=f.label.replace(/\s\s+/g," "),f.options=d.utils.extend({},{current_locale:d.app.current_locale,current_source:d.app.current_source,current_translator:d.app.current_translator,block_options:d.block_options||[]},f.options),d.app.getCurrentLanguage().translate(f)},translateLabel:function(a,b,c,e){var f=d.utils.normalizeParams(a,b,c,e);return f.options.skip_decorations=!0,d.translate(f)},translateElement:function(a){a="string"==typeof a?document.getElementById(a):a,d.config.currentLanguage=d.app.getCurrentLanguage(),this.tokenizer=new f(a,{},{debug:!1,current_source:d.app.current_source||"index",current_translator:d.app.current_translator}),/ded|te/.test(document.readyState)?this.tokenizer.translateDOM(document.body):h&&(document.body&&this.tokenizer.translateDOM(document.body),this.translateNow())},translateNow:function(){var a,b=this.tokenizer,c=function(c){var d=[];c.length>0&&(c.forEach(function(a){var b=(a.target,a.addedNodes||[]);if(b.length>0)for(var c=b.length-1;c>-1;c--){var e=b[c];e.tagName&&-1!=e.tagName.toLowerCase().indexOf("tml:")||e.tagName&&-1!=e.tagName.toLowerCase().indexOf("script")||d.push(e)}}),d.forEach(function(a){b.translateDOM(a)}),"interactive"==document.readyState&&a.disconnect())};a=new h(c),a.observe(document,{subtree:!0,attributes:!0,attributeOldValue:!1,childList:!0,characterData:!0,characterDataOldValue:!1})},translateTextNode:function(a,b,c){var e=d.utils.sanitizeString(c);if(!d.utils.isNumber(e)&&null!==e&&0!==e.length){var f=this.translate(e);/^\s/.test(c)&&(f=" "+f),/\s$/.test(c)&&(f+=" ");var g=document.createElement("span");g.innerHTML=f,a.replaceChild(g,b)}},translateTextElements:function(a){if(!d.utils.element("tml_status_node")){console.log("Initializing text nodes...");var b=document.createElement("div");b.id="tml_status_node",b.style.display="none",document.body.appendChild(b);for(var c=[],e=document.createTreeWalker(a||document.body,NodeFilter.SHOW_TEXT,null,!1);e.nextNode();)c.push(e.currentNode);console.log("Found "+c.length+" text nodes");for(i=0;i<c.length;i++){var f=c[i],g=f.parentNode;if(g&&"script"!=g.tagName&&"SCRIPT"!=g.tagName){var h=f.nodeValue||"";if(-1==h.indexOf("<img")&&-1==h.indexOf("<!-")){h.split(". ");this.translateTextNode(g,f,h)}}}}},getApplication:function(){return d.app},getCurrentSource:function(){return d.app.current_source},getCurrentTranslator:function(){return d.app.current_translator},getCurrentLanguage:function(){return d.app.getCurrentLanguage()},getLanguageSelector:function(a,b){return b=d.utils.merge(b||{},{current_language:d.getCurrentLanguage(),client_side:!0}),d.scripts.language_selector(d.app,a,b)},block:function(a,b){d.block_options.unshift(a),b(),d.block_options.pop()},beginBlock:function(a){d.block_options.unshift(a)},endBlock:function(){d.block_options.pop()},clearCache:function(){d.config.getCache().clear()}}),window.tml=d,window.tr=d.translate,window.trl=d.translateLabel,window.tre=d.translateElement,window.tml_application=d.getApplication,window.tml_current_source=d.getCurrentSource,window.tml_current_translator=d.getCurrentTranslator,window.tml_current_language=d.getCurrentLanguage,window.tml_language_selector=d.getLanguageSelector,window.tml_block=d.block,window.tml_begin_block=d.beginBlock,window.tml_end_block=d.endBlock,window.util=d.utils},{"./api_adapters/ajax":1,"./cache_adapters/browser":2,"./cache_adapters/inline":3,"./helpers":4,"./tokenizers/dom":6,"tml-js":30}],6:[function(a,b,c){var d=a("tml-js"),e=d.config,f=d.utils,g=function(a,b,c){this.doc=a,this.context=b||{},this.tokens=[],this.options=c||{}};g.prototype={content_cache:[],content_nodes:[],translate:function(){return this.translateTree(this.doc)},updateAllNodes:function(){for(var a=0,b=this.content_cache.length;b>a;a++)this.content_cache[a].container&&(this.content_cache[a].container.innerHTML=this.translateTml(this.content_cache[a].tml,this.content_cache[a].data))},replaceNodes:function(a){var b,c,d,e,f=document.createElement("tml:inline"),g=a[0]&&a[0].parentNode,h="";if(g){if(c=a.map(function(a){return h+=a.innerText||a.nodeValue,this.generateTmlTags(a)}.bind(this)).join(""),d=this.tokens,e=this.translateTml(c),!e||this.isEmptyString(c)||this.isUntranslatableText(h)||this.isNoTranslate(g))return;a.length!==g.childNodes.length?(g.insertBefore(f,a[0]),f.innerHTML=e,f.insertAdjacentHTML("beforebegin","\n"),f.insertAdjacentHTML("afterend","\n"),a.forEach(function(a){g.removeChild(a)}),b=f):(g.insertBefore(f,a[0]),f.insertAdjacentHTML("beforebegin",e),g.removeChild(f),f=null,a.forEach(function(a){g.removeChild(a)}),b=g),-1==this.content_nodes.indexOf(b)&&(this.content_cache.push({container:b,tml:c,data:d}),this.content_nodes.push(b))}},isUntranslatableText:function(a){return this.isEmptyString(a)||a.match(/^[0-9,.\s]+$/)},translatedNodes:[],translateDOM:function(a){if(-1===this.translatedNodes.indexOf(a)){if(this.translatedNodes.push(a),3==a.nodeType)return void(a.nodeValue=a.nodeValue);var b=1==a.nodeType&&this.getSourceBlock(a);b&&window.tml_begin_block({source:b});for(var c=a.childNodes.length,d=c,e=[];d--;){var f=a.childNodes[c-d-1];f&&!this.isNoTranslate(f)&&(3==f.nodeType||this.isInlineNode(f)&&this.hasInlineSiblings(f)?e.push(f):(this.replaceNodes(e),this.translateDOM(f),e=[]))}e.length>0&&this.replaceNodes(e),b&&window.tml_end_block()}},matchesUntranslatableSelector:function(a){var b,c=this.getOption("ignore_elements")||[];if(c)for(var d=0,e=c.length;e>d;d++){var f=c[d]+","+c[d]+" *";if(b=a.matches&&a.matches(f)||a.webkitMatches&&a.webkitMatches(f)||a.mozMatches&&a.mozMatches(f)||a.msMatches&&a.msMatches(f))return!0}return!1},getSourceBlock:function(a){var b,c=e.sourceElements||[];if(c)for(var d=0,f=c.length;f>d;d++){var g=c[d].selector,h=c[d].name;if(b=a.matches&&a.matches(g)||a.webkitMatches&&a.webkitMatches(g)||a.mozMatches&&a.mozMatches(g)||a.msMatches&&a.msMatches(g))return h}return a.getAttribute("data-tml-source")||!1},isNoTranslate:function(a){return 8==a.nodeType?!0:1==a.nodeType?-1!=this.getOption("nodes.scripts").indexOf(a.tagName.toLowerCase())||a.hasAttribute("notranslate")||this.matchesUntranslatableSelector(a):!1},translateTml:function(a,b){if(a=this.generateDataTokens(a),b=b||this.tokens,!this.isValidTml(a))return null;var c=a;if(this.getOption("split_sentences")){var d=f.splitSentences(a);if(d){var e=this;return d.forEach(function(a){var d=e.getOption("debug")?e.debugTranslation(a):window.tr(a,b,e.options);c=c.replace(a,d)}),this.resetContext(),c}}return a=a.replace(/[\n]/g,"").replace(/\s\s+/g," ").trim(),c=this.getOption("debug")?this.debugTranslation(a):window.tr(a,b,this.options),this.resetContext(),c},isValidTml:function(a){var b=/<\/?([a-z][a-z0-9]*)\b[^>]*>|{([a-z0-9_\.]+)}/gi;return!this.isEmptyString(a.replace(b,""))},hasChildNodes:function(a){return a.childNodes?a.childNodes.length>0:!1},isBetweenSeparators:function(a){return this.isSeparatorNode(a.previousSibling)&&!this.isValidTextNode(a.nextSibling)?!0:this.isSeparatorNode(a.nextSibling)&&!this.isValidTextNode(a.previousSibling)?!0:!1},generateTmlTags:function(a){if(3==a.nodeType)return a.nodeValue;if(this.isNoTranslate(a)){var b=this.contextualize(this.adjustName(a),a.innerHTML);return"{"+b+"}"}var c=a.tagName.toLowerCase();if("var"==c)return this.registerDataTokenFromVar(a);for(var d="",e=0;e<a.childNodes.length;e++){var f=a.childNodes[e];d+=3==f.nodeType?f.nodeValue:this.generateTmlTags(f)}var g,h=this.generateHtmlToken(a),i=this.contextualize(this.adjustName(a),h),j=this.sanitizeValue(d);return g=this.isSelfClosingNode(a)?"{"+i+"}":"<"+i+">"+j+"</"+i+">"},registerDataTokenFromVar:function(a){var b={},c="var";if(a.attributes)for(var d=0;d<a.attributes.length;d++){var e=a.attributes[d];""===e.value?c=e.name:b[e.name]=e.value}return b.value=b.value||a.innerHTML,c=this.contextualize(c,a.innerHTML),"{"+c+"}"},getOption:function(a){return"undefined"==typeof this.options[a]||null===this.options[a]?f.hashValue(e.translator_options,a):this.options[a]},debugTranslation:function(a){return this.getOption("debug_format").replace("{$0}",a)},isEmptyString:function(a){return a=a.replace(/[\s\n\r\t\0\x0b\xa0\xc2]/g,""),""===a},resetContext:function(){this.tokens=[].concat(this.context)},isShortToken:function(a,b){return-1!=this.getOption("nodes.short").indexOf(a.toLowerCase())||b.length<20},isOnlyChild:function(a){return a.parentNode?1==a.parentNode.childNodes.length:!1},hasInlineSiblings:function(a){return a.parentNode&&a.parentNode.childNodes.length>1&&a.previousSibling&&(this.isInlineNode(a.previousSibling)||this.isValidTextNode(a.previousSibling))||a.nextSibling&&(this.isInlineNode(a.nextSibling)||this.isValidTextNode(a.nextSibling))},isInlineNode:function(a){return 1==a.nodeType&&-1!=this.getOption("nodes.inline").indexOf(a.tagName.toLowerCase())&&!this.isOnlyChild(a)},isContainerNode:function(a){return 1==a.nodeType&&!this.isInlineNode(a)},isSelfClosingNode:function(a){return!a.firstChild},isIgnoredNode:function(a){return 1!=a.nodeType?!0:-1!=this.getOption("nodes.ignored").indexOf(a.tagName.toLowerCase())},isValidTextNode:function(a){return a?3==a.nodeType&&!this.isEmptyString(a.nodeValue):!1},isSeparatorNode:function(a){return a?1==a.nodeType&&-1!=this.getOption("nodes.splitters").indexOf(a.tagName.toLowerCase()):!1},sanitizeValue:function(a){return a.replace(/^\s+/,"")},replaceSpecialCharacters:function(a){if(!this.getOption("data_tokens.special.enabled"))return a;var b=a.match(this.getOption("data_tokens.special.regex")),c=this;return b.forEach(function(b){token=b.substring(1,b.length-2),c.context[token]=b,a=a.replace(b,"{"+token+"}")}),a},generateDataTokens:function(a){var b=this;a=this.sanitizeValue(a);var c=null;if(this.getOption("data_tokens.date.enabled")){c=b.getOption("data_tokens.date.name");var d=b.getOption("data_tokens.date.formats");d.forEach(function(d){var e=d[0],f=(d[1],a.match(e));f&&f.forEach(function(d){var e=d,f=b.contextualize(c,e),g="{"+f+"}";a=a.replace(d,g)})})}var e=this.getOption("data_tokens.rules");return e&&e.forEach(function(c){if(c.enabled){var d=a.match(c.regex);d&&d.forEach(function(d){var e=d.trim();if(""!==e){var f=b.contextualize(c.name,e),g=d.replace(e,"{"+f+"}");a=a.replace(d,g)}})}}),a},generateHtmlToken:function(a,b){var c=a.tagName.toLowerCase(),d=a.attributes,e={};if(b=b?b:"{$0}",0===d.length)return this.isSelfClosingNode(a)?"br"==c||"hr"==c?"<"+c+"/>":"<"+c+"></"+c+">":"<"+c+">"+b+"</"+c+">";for(var g=0;g<d.length;g++)e[d[g].name]=d[g].value;var h=f.keys(e);h.sort();var i=[];return h.forEach(function(a){var b=-1!=e[a].indexOf("'")?'"':"'";i.push(a+"="+b+e[a]+b)}),i=i.join(" "),this.isSelfClosingNode(a)?"<"+c+" "+i+"></"+c+">":"<"+c+" "+i+">"+b+"</"+c+">"},adjustName:function(a){var b=a.tagName.toLowerCase(),c=this.getOption("name_mapping");return b=c[b]?c[b]:b},contextualize:function(a,b){if(this.tokens[a]&&this.tokens[a]!=b){var c=0,d=a.match(/\d+$/);return d&&d.length>0&&(c=parseInt(d[d.length-1]),a=a.replace(""+c,"")),a+=c+1,this.contextualize(a,b)}return this.tokens[a]=b,a},debug:function(a){this.doc=a,this.debugTree(a,0)},debugTree:function(a,b){var c=new Array(b+1).join("=");if(console.log(c+"=> "+typeof a+": "+this.nodeInfo(a)),a.childNodes)for(var d=this,e=0;e<a.childNodes.length;e++){var f=a.childNodes[e];d.debugTree(f,b+1)}},nodeInfo:function(a){var b=[];return b.push(a.nodeType),1==a.nodeType&&b.push(a.tagName),this.isInlineNode(a)&&(b.push("inline"),this.hasInlineSiblings(a)?b.push("sentence"):b.push("only translatable")),this.isSelfClosingNode(a)&&b.push("self closing"),this.isOnlyChild(a)&&b.push("only child"),3==a.nodeType?"["+b.join(", ")+']: "'+a.nodeValue+'"':"["+b.join(", ")+"]"}},b.exports=g},{"tml-js":30}],7:[function(a,b,c){function d(){return e.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function e(a){return this instanceof e?(this.length=0,this.parent=void 0,"number"==typeof a?f(this,a):"string"==typeof a?g(this,a,arguments.length>1?arguments[1]:"utf8"):h(this,a)):arguments.length>1?new e(a,arguments[1]):new e(a)}function f(a,b){if(a=o(a,0>b?0:0|p(b)),!e.TYPED_ARRAY_SUPPORT)for(var c=0;b>c;c++)a[c]=0;return a}function g(a,b,c){("string"!=typeof c||""===c)&&(c="utf8");var d=0|r(b,c);return a=o(a,d),a.write(b,c),a}function h(a,b){if(e.isBuffer(b))return i(a,b);if(X(b))return j(a,b);if(null==b)throw new TypeError("must start with number, buffer, array or string");if("undefined"!=typeof ArrayBuffer){if(b.buffer instanceof ArrayBuffer)return k(a,b);if(b instanceof ArrayBuffer)return l(a,b)}return b.length?m(a,b):n(a,b)}function i(a,b){var c=0|p(b.length);return a=o(a,c),b.copy(a,0,0,c),a}function j(a,b){var c=0|p(b.length);a=o(a,c);for(var d=0;c>d;d+=1)a[d]=255&b[d];return a}function k(a,b){var c=0|p(b.length);a=o(a,c);for(var d=0;c>d;d+=1)a[d]=255&b[d];return a}function l(a,b){return e.TYPED_ARRAY_SUPPORT?(b.byteLength,a=e._augment(new Uint8Array(b))):a=k(a,new Uint8Array(b)),a}function m(a,b){var c=0|p(b.length);a=o(a,c);for(var d=0;c>d;d+=1)a[d]=255&b[d];return a}function n(a,b){var c,d=0;"Buffer"===b.type&&X(b.data)&&(c=b.data,d=0|p(c.length)),a=o(a,d);for(var e=0;d>e;e+=1)a[e]=255&c[e];return a}function o(a,b){e.TYPED_ARRAY_SUPPORT?a=e._augment(new Uint8Array(b)):(a.length=b,a._isBuffer=!0);var c=0!==b&&b<=e.poolSize>>>1;return c&&(a.parent=Y),a}function p(a){if(a>=d())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+d().toString(16)+" bytes");return 0|a}function q(a,b){if(!(this instanceof q))return new q(a,b);var c=new e(a,b);return delete c.parent,c}function r(a,b){"string"!=typeof a&&(a=""+a);var c=a.length;if(0===c)return 0;for(var d=!1;;)switch(b){case"ascii":case"binary":case"raw":case"raws":return c;case"utf8":case"utf-8":return Q(a).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*c;case"hex":return c>>>1;case"base64":return T(a).length;default:if(d)return Q(a).length;b=(""+b).toLowerCase(),d=!0}}function s(a,b,c){var d=!1;if(b=0|b,c=void 0===c||c===1/0?this.length:0|c,a||(a="utf8"),0>b&&(b=0),c>this.length&&(c=this.length),b>=c)return"";for(;;)switch(a){case"hex":return E(this,b,c);case"utf8":case"utf-8":return A(this,b,c);case"ascii":return C(this,b,c);case"binary":return D(this,b,c);case"base64":return z(this,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return F(this,b,c);default:if(d)throw new TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase(),d=!0}}function t(a,b,c,d){c=Number(c)||0;var e=a.length-c;d?(d=Number(d),d>e&&(d=e)):d=e;var f=b.length;if(f%2!==0)throw new Error("Invalid hex string");d>f/2&&(d=f/2);for(var g=0;d>g;g++){var h=parseInt(b.substr(2*g,2),16);if(isNaN(h))throw new Error("Invalid hex string");a[c+g]=h}return g}function u(a,b,c,d){return U(Q(b,a.length-c),a,c,d)}function v(a,b,c,d){return U(R(b),a,c,d)}function w(a,b,c,d){return v(a,b,c,d)}function x(a,b,c,d){return U(T(b),a,c,d)}function y(a,b,c,d){return U(S(b,a.length-c),a,c,d)}function z(a,b,c){return 0===b&&c===a.length?V.fromByteArray(a):V.fromByteArray(a.slice(b,c))}function A(a,b,c){c=Math.min(a.length,c);for(var d=[],e=b;c>e;){var f=a[e],g=null,h=f>239?4:f>223?3:f>191?2:1;if(c>=e+h){var i,j,k,l;switch(h){case 1:128>f&&(g=f);break;case 2:i=a[e+1],128===(192&i)&&(l=(31&f)<<6|63&i,l>127&&(g=l));break;case 3:i=a[e+1],j=a[e+2],128===(192&i)&&128===(192&j)&&(l=(15&f)<<12|(63&i)<<6|63&j,l>2047&&(55296>l||l>57343)&&(g=l));break;case 4:i=a[e+1],j=a[e+2],k=a[e+3],128===(192&i)&&128===(192&j)&&128===(192&k)&&(l=(15&f)<<18|(63&i)<<12|(63&j)<<6|63&k,l>65535&&1114112>l&&(g=l))}}null===g?(g=65533,h=1):g>65535&&(g-=65536,d.push(g>>>10&1023|55296),g=56320|1023&g),d.push(g),e+=h}return B(d)}function B(a){var b=a.length;if(Z>=b)return String.fromCharCode.apply(String,a);for(var c="",d=0;b>d;)c+=String.fromCharCode.apply(String,a.slice(d,d+=Z));return c}function C(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;c>e;e++)d+=String.fromCharCode(127&a[e]);return d}function D(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;c>e;e++)d+=String.fromCharCode(a[e]);return d}function E(a,b,c){var d=a.length;(!b||0>b)&&(b=0),(!c||0>c||c>d)&&(c=d);for(var e="",f=b;c>f;f++)e+=P(a[f]);return e}function F(a,b,c){for(var d=a.slice(b,c),e="",f=0;f<d.length;f+=2)e+=String.fromCharCode(d[f]+256*d[f+1]);return e}function G(a,b,c){if(a%1!==0||0>a)throw new RangeError("offset is not uint");if(a+b>c)throw new RangeError("Trying to access beyond buffer length")}function H(a,b,c,d,f,g){if(!e.isBuffer(a))throw new TypeError("buffer must be a Buffer instance");if(b>f||g>b)throw new RangeError("value is out of bounds");if(c+d>a.length)throw new RangeError("index out of range")}function I(a,b,c,d){0>b&&(b=65535+b+1);for(var e=0,f=Math.min(a.length-c,2);f>e;e++)a[c+e]=(b&255<<8*(d?e:1-e))>>>8*(d?e:1-e)}function J(a,b,c,d){0>b&&(b=4294967295+b+1);for(var e=0,f=Math.min(a.length-c,4);f>e;e++)a[c+e]=b>>>8*(d?e:3-e)&255}function K(a,b,c,d,e,f){if(b>e||f>b)throw new RangeError("value is out of bounds");if(c+d>a.length)throw new RangeError("index out of range");if(0>c)throw new RangeError("index out of range")}function L(a,b,c,d,e){return e||K(a,b,c,4,3.4028234663852886e38,-3.4028234663852886e38),W.write(a,b,c,d,23,4),c+4}function M(a,b,c,d,e){return e||K(a,b,c,8,1.7976931348623157e308,-1.7976931348623157e308),W.write(a,b,c,d,52,8),c+8}function N(a){if(a=O(a).replace(_,""),a.length<2)return"";for(;a.length%4!==0;)a+="=";return a}function O(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function P(a){return 16>a?"0"+a.toString(16):a.toString(16)}function Q(a,b){b=b||1/0;for(var c,d=a.length,e=null,f=[],g=0;d>g;g++){if(c=a.charCodeAt(g),c>55295&&57344>c){if(!e){if(c>56319){(b-=3)>-1&&f.push(239,191,189);continue}if(g+1===d){(b-=3)>-1&&f.push(239,191,189);continue}e=c;continue}if(56320>c){(b-=3)>-1&&f.push(239,191,189),e=c;continue}c=e-55296<<10|c-56320|65536}else e&&(b-=3)>-1&&f.push(239,191,189);if(e=null,128>c){if((b-=1)<0)break;f.push(c)}else if(2048>c){if((b-=2)<0)break;f.push(c>>6|192,63&c|128)}else if(65536>c){if((b-=3)<0)break;f.push(c>>12|224,c>>6&63|128,63&c|128)}else{if(!(1114112>c))throw new Error("Invalid code point");if((b-=4)<0)break;f.push(c>>18|240,c>>12&63|128,c>>6&63|128,63&c|128)}}return f}function R(a){for(var b=[],c=0;c<a.length;c++)b.push(255&a.charCodeAt(c));return b}function S(a,b){for(var c,d,e,f=[],g=0;g<a.length&&!((b-=2)<0);g++)c=a.charCodeAt(g),d=c>>8,e=c%256,f.push(e),f.push(d);return f}function T(a){return V.toByteArray(N(a))}function U(a,b,c,d){for(var e=0;d>e&&!(e+c>=b.length||e>=a.length);e++)b[e+c]=a[e];return e}var V=a("base64-js"),W=a("ieee754"),X=a("is-array");c.Buffer=e,c.SlowBuffer=q,c.INSPECT_MAX_BYTES=50,e.poolSize=8192;var Y={};e.TYPED_ARRAY_SUPPORT=function(){function a(){}try{var b=new Uint8Array(1);return b.foo=function(){return 42},b.constructor=a,42===b.foo()&&b.constructor===a&&"function"==typeof b.subarray&&0===b.subarray(1,1).byteLength}catch(c){return!1}}(),e.isBuffer=function(a){return!(null==a||!a._isBuffer)},e.compare=function(a,b){if(!e.isBuffer(a)||!e.isBuffer(b))throw new TypeError("Arguments must be Buffers");if(a===b)return 0;for(var c=a.length,d=b.length,f=0,g=Math.min(c,d);g>f&&a[f]===b[f];)++f;return f!==g&&(c=a[f],d=b[f]),d>c?-1:c>d?1:0},e.isEncoding=function(a){switch(String(a).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},e.concat=function(a,b){if(!X(a))throw new TypeError("list argument must be an Array of Buffers.");if(0===a.length)return new e(0);var c;if(void 0===b)for(b=0,c=0;c<a.length;c++)b+=a[c].length;var d=new e(b),f=0;for(c=0;c<a.length;c++){var g=a[c];g.copy(d,f),f+=g.length}return d},e.byteLength=r,e.prototype.length=void 0,e.prototype.parent=void 0,e.prototype.toString=function(){var a=0|this.length;return 0===a?"":0===arguments.length?A(this,0,a):s.apply(this,arguments)},e.prototype.equals=function(a){if(!e.isBuffer(a))throw new TypeError("Argument must be a Buffer");return this===a?!0:0===e.compare(this,a)},e.prototype.inspect=function(){var a="",b=c.INSPECT_MAX_BYTES;return this.length>0&&(a=this.toString("hex",0,b).match(/.{2}/g).join(" "),this.length>b&&(a+=" ... ")),"<Buffer "+a+">"},e.prototype.compare=function(a){if(!e.isBuffer(a))throw new TypeError("Argument must be a Buffer");return this===a?0:e.compare(this,a)},e.prototype.indexOf=function(a,b){function c(a,b,c){for(var d=-1,e=0;c+e<a.length;e++)if(a[c+e]===b[-1===d?0:e-d]){if(-1===d&&(d=e),e-d+1===b.length)return c+d}else d=-1;return-1}if(b>2147483647?b=2147483647:-2147483648>b&&(b=-2147483648),b>>=0,0===this.length)return-1;if(b>=this.length)return-1;if(0>b&&(b=Math.max(this.length+b,0)),"string"==typeof a)return 0===a.length?-1:String.prototype.indexOf.call(this,a,b);if(e.isBuffer(a))return c(this,a,b);if("number"==typeof a)return e.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,a,b):c(this,[a],b);throw new TypeError("val must be string, number or Buffer")},e.prototype.get=function(a){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(a)},e.prototype.set=function(a,b){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(a,b)},e.prototype.write=function(a,b,c,d){if(void 0===b)d="utf8",c=this.length,b=0;else if(void 0===c&&"string"==typeof b)d=b,c=this.length,b=0;else if(isFinite(b))b=0|b,isFinite(c)?(c=0|c,void 0===d&&(d="utf8")):(d=c,c=void 0);else{var e=d;d=b,b=0|c,c=e}var f=this.length-b;if((void 0===c||c>f)&&(c=f),a.length>0&&(0>c||0>b)||b>this.length)throw new RangeError("attempt to write outside buffer bounds");d||(d="utf8");for(var g=!1;;)switch(d){case"hex":return t(this,a,b,c);case"utf8":case"utf-8":return u(this,a,b,c);case"ascii":return v(this,a,b,c);case"binary":return w(this,a,b,c);case"base64":return x(this,a,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return y(this,a,b,c);default:if(g)throw new TypeError("Unknown encoding: "+d);d=(""+d).toLowerCase(),g=!0}},e.prototype.toJSON=function(){
return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Z=4096;e.prototype.slice=function(a,b){var c=this.length;a=~~a,b=void 0===b?c:~~b,0>a?(a+=c,0>a&&(a=0)):a>c&&(a=c),0>b?(b+=c,0>b&&(b=0)):b>c&&(b=c),a>b&&(b=a);var d;if(e.TYPED_ARRAY_SUPPORT)d=e._augment(this.subarray(a,b));else{var f=b-a;d=new e(f,void 0);for(var g=0;f>g;g++)d[g]=this[g+a]}return d.length&&(d.parent=this.parent||this),d},e.prototype.readUIntLE=function(a,b,c){a=0|a,b=0|b,c||G(a,b,this.length);for(var d=this[a],e=1,f=0;++f<b&&(e*=256);)d+=this[a+f]*e;return d},e.prototype.readUIntBE=function(a,b,c){a=0|a,b=0|b,c||G(a,b,this.length);for(var d=this[a+--b],e=1;b>0&&(e*=256);)d+=this[a+--b]*e;return d},e.prototype.readUInt8=function(a,b){return b||G(a,1,this.length),this[a]},e.prototype.readUInt16LE=function(a,b){return b||G(a,2,this.length),this[a]|this[a+1]<<8},e.prototype.readUInt16BE=function(a,b){return b||G(a,2,this.length),this[a]<<8|this[a+1]},e.prototype.readUInt32LE=function(a,b){return b||G(a,4,this.length),(this[a]|this[a+1]<<8|this[a+2]<<16)+16777216*this[a+3]},e.prototype.readUInt32BE=function(a,b){return b||G(a,4,this.length),16777216*this[a]+(this[a+1]<<16|this[a+2]<<8|this[a+3])},e.prototype.readIntLE=function(a,b,c){a=0|a,b=0|b,c||G(a,b,this.length);for(var d=this[a],e=1,f=0;++f<b&&(e*=256);)d+=this[a+f]*e;return e*=128,d>=e&&(d-=Math.pow(2,8*b)),d},e.prototype.readIntBE=function(a,b,c){a=0|a,b=0|b,c||G(a,b,this.length);for(var d=b,e=1,f=this[a+--d];d>0&&(e*=256);)f+=this[a+--d]*e;return e*=128,f>=e&&(f-=Math.pow(2,8*b)),f},e.prototype.readInt8=function(a,b){return b||G(a,1,this.length),128&this[a]?-1*(255-this[a]+1):this[a]},e.prototype.readInt16LE=function(a,b){b||G(a,2,this.length);var c=this[a]|this[a+1]<<8;return 32768&c?4294901760|c:c},e.prototype.readInt16BE=function(a,b){b||G(a,2,this.length);var c=this[a+1]|this[a]<<8;return 32768&c?4294901760|c:c},e.prototype.readInt32LE=function(a,b){return b||G(a,4,this.length),this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24},e.prototype.readInt32BE=function(a,b){return b||G(a,4,this.length),this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]},e.prototype.readFloatLE=function(a,b){return b||G(a,4,this.length),W.read(this,a,!0,23,4)},e.prototype.readFloatBE=function(a,b){return b||G(a,4,this.length),W.read(this,a,!1,23,4)},e.prototype.readDoubleLE=function(a,b){return b||G(a,8,this.length),W.read(this,a,!0,52,8)},e.prototype.readDoubleBE=function(a,b){return b||G(a,8,this.length),W.read(this,a,!1,52,8)},e.prototype.writeUIntLE=function(a,b,c,d){a=+a,b=0|b,c=0|c,d||H(this,a,b,c,Math.pow(2,8*c),0);var e=1,f=0;for(this[b]=255&a;++f<c&&(e*=256);)this[b+f]=a/e&255;return b+c},e.prototype.writeUIntBE=function(a,b,c,d){a=+a,b=0|b,c=0|c,d||H(this,a,b,c,Math.pow(2,8*c),0);var e=c-1,f=1;for(this[b+e]=255&a;--e>=0&&(f*=256);)this[b+e]=a/f&255;return b+c},e.prototype.writeUInt8=function(a,b,c){return a=+a,b=0|b,c||H(this,a,b,1,255,0),e.TYPED_ARRAY_SUPPORT||(a=Math.floor(a)),this[b]=a,b+1},e.prototype.writeUInt16LE=function(a,b,c){return a=+a,b=0|b,c||H(this,a,b,2,65535,0),e.TYPED_ARRAY_SUPPORT?(this[b]=a,this[b+1]=a>>>8):I(this,a,b,!0),b+2},e.prototype.writeUInt16BE=function(a,b,c){return a=+a,b=0|b,c||H(this,a,b,2,65535,0),e.TYPED_ARRAY_SUPPORT?(this[b]=a>>>8,this[b+1]=a):I(this,a,b,!1),b+2},e.prototype.writeUInt32LE=function(a,b,c){return a=+a,b=0|b,c||H(this,a,b,4,4294967295,0),e.TYPED_ARRAY_SUPPORT?(this[b+3]=a>>>24,this[b+2]=a>>>16,this[b+1]=a>>>8,this[b]=a):J(this,a,b,!0),b+4},e.prototype.writeUInt32BE=function(a,b,c){return a=+a,b=0|b,c||H(this,a,b,4,4294967295,0),e.TYPED_ARRAY_SUPPORT?(this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=a):J(this,a,b,!1),b+4},e.prototype.writeIntLE=function(a,b,c,d){if(a=+a,b=0|b,!d){var e=Math.pow(2,8*c-1);H(this,a,b,c,e-1,-e)}var f=0,g=1,h=0>a?1:0;for(this[b]=255&a;++f<c&&(g*=256);)this[b+f]=(a/g>>0)-h&255;return b+c},e.prototype.writeIntBE=function(a,b,c,d){if(a=+a,b=0|b,!d){var e=Math.pow(2,8*c-1);H(this,a,b,c,e-1,-e)}var f=c-1,g=1,h=0>a?1:0;for(this[b+f]=255&a;--f>=0&&(g*=256);)this[b+f]=(a/g>>0)-h&255;return b+c},e.prototype.writeInt8=function(a,b,c){return a=+a,b=0|b,c||H(this,a,b,1,127,-128),e.TYPED_ARRAY_SUPPORT||(a=Math.floor(a)),0>a&&(a=255+a+1),this[b]=a,b+1},e.prototype.writeInt16LE=function(a,b,c){return a=+a,b=0|b,c||H(this,a,b,2,32767,-32768),e.TYPED_ARRAY_SUPPORT?(this[b]=a,this[b+1]=a>>>8):I(this,a,b,!0),b+2},e.prototype.writeInt16BE=function(a,b,c){return a=+a,b=0|b,c||H(this,a,b,2,32767,-32768),e.TYPED_ARRAY_SUPPORT?(this[b]=a>>>8,this[b+1]=a):I(this,a,b,!1),b+2},e.prototype.writeInt32LE=function(a,b,c){return a=+a,b=0|b,c||H(this,a,b,4,2147483647,-2147483648),e.TYPED_ARRAY_SUPPORT?(this[b]=a,this[b+1]=a>>>8,this[b+2]=a>>>16,this[b+3]=a>>>24):J(this,a,b,!0),b+4},e.prototype.writeInt32BE=function(a,b,c){return a=+a,b=0|b,c||H(this,a,b,4,2147483647,-2147483648),0>a&&(a=4294967295+a+1),e.TYPED_ARRAY_SUPPORT?(this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=a):J(this,a,b,!1),b+4},e.prototype.writeFloatLE=function(a,b,c){return L(this,a,b,!0,c)},e.prototype.writeFloatBE=function(a,b,c){return L(this,a,b,!1,c)},e.prototype.writeDoubleLE=function(a,b,c){return M(this,a,b,!0,c)},e.prototype.writeDoubleBE=function(a,b,c){return M(this,a,b,!1,c)},e.prototype.copy=function(a,b,c,d){if(c||(c=0),d||0===d||(d=this.length),b>=a.length&&(b=a.length),b||(b=0),d>0&&c>d&&(d=c),d===c)return 0;if(0===a.length||0===this.length)return 0;if(0>b)throw new RangeError("targetStart out of bounds");if(0>c||c>=this.length)throw new RangeError("sourceStart out of bounds");if(0>d)throw new RangeError("sourceEnd out of bounds");d>this.length&&(d=this.length),a.length-b<d-c&&(d=a.length-b+c);var f,g=d-c;if(this===a&&b>c&&d>b)for(f=g-1;f>=0;f--)a[f+b]=this[f+c];else if(1e3>g||!e.TYPED_ARRAY_SUPPORT)for(f=0;g>f;f++)a[f+b]=this[f+c];else a._set(this.subarray(c,c+g),b);return g},e.prototype.fill=function(a,b,c){if(a||(a=0),b||(b=0),c||(c=this.length),b>c)throw new RangeError("end < start");if(c!==b&&0!==this.length){if(0>b||b>=this.length)throw new RangeError("start out of bounds");if(0>c||c>this.length)throw new RangeError("end out of bounds");var d;if("number"==typeof a)for(d=b;c>d;d++)this[d]=a;else{var e=Q(a.toString()),f=e.length;for(d=b;c>d;d++)this[d]=e[d%f]}return this}},e.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(e.TYPED_ARRAY_SUPPORT)return new e(this).buffer;for(var a=new Uint8Array(this.length),b=0,c=a.length;c>b;b+=1)a[b]=this[b];return a.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var $=e.prototype;e._augment=function(a){return a.constructor=e,a._isBuffer=!0,a._set=a.set,a.get=$.get,a.set=$.set,a.write=$.write,a.toString=$.toString,a.toLocaleString=$.toString,a.toJSON=$.toJSON,a.equals=$.equals,a.compare=$.compare,a.indexOf=$.indexOf,a.copy=$.copy,a.slice=$.slice,a.readUIntLE=$.readUIntLE,a.readUIntBE=$.readUIntBE,a.readUInt8=$.readUInt8,a.readUInt16LE=$.readUInt16LE,a.readUInt16BE=$.readUInt16BE,a.readUInt32LE=$.readUInt32LE,a.readUInt32BE=$.readUInt32BE,a.readIntLE=$.readIntLE,a.readIntBE=$.readIntBE,a.readInt8=$.readInt8,a.readInt16LE=$.readInt16LE,a.readInt16BE=$.readInt16BE,a.readInt32LE=$.readInt32LE,a.readInt32BE=$.readInt32BE,a.readFloatLE=$.readFloatLE,a.readFloatBE=$.readFloatBE,a.readDoubleLE=$.readDoubleLE,a.readDoubleBE=$.readDoubleBE,a.writeUInt8=$.writeUInt8,a.writeUIntLE=$.writeUIntLE,a.writeUIntBE=$.writeUIntBE,a.writeUInt16LE=$.writeUInt16LE,a.writeUInt16BE=$.writeUInt16BE,a.writeUInt32LE=$.writeUInt32LE,a.writeUInt32BE=$.writeUInt32BE,a.writeIntLE=$.writeIntLE,a.writeIntBE=$.writeIntBE,a.writeInt8=$.writeInt8,a.writeInt16LE=$.writeInt16LE,a.writeInt16BE=$.writeInt16BE,a.writeInt32LE=$.writeInt32LE,a.writeInt32BE=$.writeInt32BE,a.writeFloatLE=$.writeFloatLE,a.writeFloatBE=$.writeFloatBE,a.writeDoubleLE=$.writeDoubleLE,a.writeDoubleBE=$.writeDoubleBE,a.fill=$.fill,a.inspect=$.inspect,a.toArrayBuffer=$.toArrayBuffer,a};var _=/[^+\/0-9A-Za-z-_]/g},{"base64-js":8,ieee754:9,"is-array":10}],8:[function(a,b,c){var d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(a){"use strict";function b(a){var b=a.charCodeAt(0);return b===g||b===l?62:b===h||b===m?63:i>b?-1:i+10>b?b-i+26+26:k+26>b?b-k:j+26>b?b-j+26:void 0}function c(a){function c(a){j[l++]=a}var d,e,g,h,i,j;if(a.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var k=a.length;i="="===a.charAt(k-2)?2:"="===a.charAt(k-1)?1:0,j=new f(3*a.length/4-i),g=i>0?a.length-4:a.length;var l=0;for(d=0,e=0;g>d;d+=4,e+=3)h=b(a.charAt(d))<<18|b(a.charAt(d+1))<<12|b(a.charAt(d+2))<<6|b(a.charAt(d+3)),c((16711680&h)>>16),c((65280&h)>>8),c(255&h);return 2===i?(h=b(a.charAt(d))<<2|b(a.charAt(d+1))>>4,c(255&h)):1===i&&(h=b(a.charAt(d))<<10|b(a.charAt(d+1))<<4|b(a.charAt(d+2))>>2,c(h>>8&255),c(255&h)),j}function e(a){function b(a){return d.charAt(a)}function c(a){return b(a>>18&63)+b(a>>12&63)+b(a>>6&63)+b(63&a)}var e,f,g,h=a.length%3,i="";for(e=0,g=a.length-h;g>e;e+=3)f=(a[e]<<16)+(a[e+1]<<8)+a[e+2],i+=c(f);switch(h){case 1:f=a[a.length-1],i+=b(f>>2),i+=b(f<<4&63),i+="==";break;case 2:f=(a[a.length-2]<<8)+a[a.length-1],i+=b(f>>10),i+=b(f>>4&63),i+=b(f<<2&63),i+="="}return i}var f="undefined"!=typeof Uint8Array?Uint8Array:Array,g="+".charCodeAt(0),h="/".charCodeAt(0),i="0".charCodeAt(0),j="a".charCodeAt(0),k="A".charCodeAt(0),l="-".charCodeAt(0),m="_".charCodeAt(0);a.toByteArray=c,a.fromByteArray=e}("undefined"==typeof c?this.base64js={}:c)},{}],9:[function(a,b,c){c.read=function(a,b,c,d,e){var f,g,h=8*e-d-1,i=(1<<h)-1,j=i>>1,k=-7,l=c?e-1:0,m=c?-1:1,n=a[b+l];for(l+=m,f=n&(1<<-k)-1,n>>=-k,k+=h;k>0;f=256*f+a[b+l],l+=m,k-=8);for(g=f&(1<<-k)-1,f>>=-k,k+=d;k>0;g=256*g+a[b+l],l+=m,k-=8);if(0===f)f=1-j;else{if(f===i)return g?NaN:(n?-1:1)*(1/0);g+=Math.pow(2,d),f-=j}return(n?-1:1)*g*Math.pow(2,f-d)},c.write=function(a,b,c,d,e,f){var g,h,i,j=8*f-e-1,k=(1<<j)-1,l=k>>1,m=23===e?Math.pow(2,-24)-Math.pow(2,-77):0,n=d?0:f-1,o=d?1:-1,p=0>b||0===b&&0>1/b?1:0;for(b=Math.abs(b),isNaN(b)||b===1/0?(h=isNaN(b)?1:0,g=k):(g=Math.floor(Math.log(b)/Math.LN2),b*(i=Math.pow(2,-g))<1&&(g--,i*=2),b+=g+l>=1?m/i:m*Math.pow(2,1-l),b*i>=2&&(g++,i/=2),g+l>=k?(h=0,g=k):g+l>=1?(h=(b*i-1)*Math.pow(2,e),g+=l):(h=b*Math.pow(2,l-1)*Math.pow(2,e),g=0));e>=8;a[c+n]=255&h,n+=o,h/=256,e-=8);for(g=g<<e|h,j+=e;j>0;a[c+n]=255&g,n+=o,g/=256,j-=8);a[c+n-o]|=128*p}},{}],10:[function(a,b,c){var d=Array.isArray,e=Object.prototype.toString;b.exports=d||function(a){return!!a&&"[object Array]"==e.call(a)}},{}],11:[function(a,b,c){b.exports={enabled:!0,default_locale:"en",source_separator:"@:@",delayed_flush:!1,debug:!1,default_tokens:{html:{data:{ndash:"&ndash;",mdash:"&mdash;",iexcl:"&iexcl;",iquest:"&iquest;",quot:"&quot;",ldquo:"&ldquo;",rdquo:"&rdquo;",lsquo:"&lsquo;",rsquo:"&rsquo;",laquo:"&laquo;",raquo:"&raquo;",nbsp:"&nbsp;",lsaquo:"&lsaquo;",rsaquo:"&rsaquo;",br:"<br/>",lbrace:"{",rbrace:"}",trade:"&trade;"},decoration:{strong:"<strong>{$0}</strong>",bold:"<strong>{$0}</strong>",b:"<strong>{$0}</strong>",em:"<em>{$0}</em>",italic:"<i>{$0}</i>",i:"<i>{$0}</i>",link:"<a href='{$href}' class='{$class}' style='{$style}'>{$0}</a>",br:"<br>{$0}",strike:"<strike>{$0}</strike>",div:"<div id='{$id}' class='{$class}' style='{$style}'>{$0}</div>",span:"<span id='{$id}' class='{$class}' style='{$style}'>{$0}</span>",h1:"<h1>{$0}</h1>",h2:"<h2>{$0}</h2>",h3:"<h3>{$0}</h3>"}},text:{data:{ndash:"–",mdash:"-",iexcl:"¡",iquest:"¿",quot:'"',ldquo:"“",rdquo:"”",lsquo:"‘",rsquo:"’",laquo:"«",raquo:"»",nbsp:" ",lsaquo:"‹",rsaquo:"›",br:"\n",lbrace:"{",rbrace:"}",trade:"™"},decoration:{strong:"{$0}",bold:"{$0}",b:"{$0}",em:"{$0}",italic:"{$0}",i:"{$0}",link:"{$0}{$1}",br:"\n{$0}",strike:"{$0}",div:"{$0}",span:"{$0}",h1:"{$0}",h2:"{$0}",h3:"{$0}"}}},translator_options:{debug:!1,debug_format_html:"<span style='font-size:20px;color:red;'>{</span> {$0} <span style='font-size:20px;color:red;'>}</span>",debug_format:"{{{{$0}}}}",split_sentences:!0,decoration_token_format:"[]",ignore_elements:[".notranslate"],nodes:{ignored:[],scripts:["iframe","script","noscript","style","audio","video","map","object","track","embed","svg","code","ruby"],inline:["a","span","i","b","img","strong","s","em","u","sub","sup","var"],"short":["i","b"],splitters:["br","hr"]},attributes:{labels:["title","alt"]},name_mapping:{b:"bold",i:"italic",a:"link",img:"picture"},data_tokens:{special:{enable:!0,regex:/(&[^;]*;)/g},date:{enabled:!0,formats:[[/(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s+\d+,\s+\d+/g,"{month} {day}, {year}"],[/(January|February|March|April|May|June|July|August|September|October|November|December)\s+\d+,\s+\d+/g,"{month} {day}, {year}"],[/\d+\s+(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec),\s+\d+/g,"{day} {month}, {year}"],[/\d+\s+(January|February|March|April|May|June|July|August|September|October|November|December),\s+\d+/g,"{day} {month}, {year}"]],name:"date"},rules:[{enabled:!0,name:"phone",regex:/(\d{1}-)?\d{3}-\d{3}-\d{4}|\d?\(\d{3}\)\s*\d{3}-\d{4}|(\d.)?\d{3}.\d{3}.\d{4}/g},{enabled:!0,name:"email",regex:/[-a-z0-9~!$%^&*_=+}{\'?]+(\.[-a-z0-9~!$%^&*_=+}{\'?]+)*@([a-z0-9_][-a-z0-9_]*(\.[-a-z0-9_]+)*\.(aero|arpa|biz|com|coop|edu|gov|info|int|mil|museum|name|net|org|pro|travel|io|mobi|[a-z][a-z])|([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}))(:[0-9]{1,5})?/g},{enabled:!0,name:"price",regex:/\$\d*(,\d*)*(\.\d*)?/g},{enabled:!0,name:"fraction",regex:/\d+\/\d+/g},{enabled:!0,name:"num",regex:/\b\d+(,\d*)*(\.\d*)?%?\b/g}]}},context_rules:{number:{variables:{}},gender:{variables:{"@gender":"gender"}},genders:{variables:{"@genders":function(a){var b=[];return a.forEach(function(a){b.push(a.gender)}),b}}},date:{variables:{}},time:{variables:{}}}}},{}],12:[function(a,b,c){var d=function(){};d.prototype={get:function(a,b,c){throw new Error("Must be implemented by the extending class")},post:function(a,b,c){throw new Error("Must be implemented by the extending class")}},b.exports=d},{}],13:[function(a,b,c){var d=a("./logger"),e=a("./utils"),f=a("./configuration"),g=a("./api_adapters/base"),h="/v1/",i="https://cdn.translationexchange.com",j=function(a){this.application=a,this.cache=f.getCache();var b=f.getApiAdapter(f.api);b.prototype=e.extend(new g,b.prototype),this.adapter=new b};j.prototype={normalizeParams:function(a,b,c,d){return e.isFunction(b)?(d=b,b={}):e.isFunction(c)&&(d=c,c={}),c=c||{},{path:a,params:b,options:c,callback:d}},getReleaseVersion:function(a){var b=this,c=b.application.getHost()+h+"projects/current/version";d.log("fetching release version: "+c),b.adapter.get(c,{access_token:b.application.token},function(b,c,e){return d.debug("Fetched release version: "+e),b||!e?void a("0"):void a(e)})},updateReleaseVersion:function(a){var b=this;b.getReleaseVersion(function(c){b.cache.storeVersion(c,function(b){d.log("Caching release version as: "+b),a(b)})})},fetchReleaseVersion:function(a){if(this.cache.version&&"undefined"!=this.cache.version)return void a(this.cache.version);var b=this;this.cache.fetchVersion(function(c){c&&"undefined"!=c?(b.cache.setVersion(c),a(c)):b.updateReleaseVersion(function(b){a(b)})})},fetchFromCdn:function(a,b){var c=this;if("0"==c.cache.version)return void b(null,null);var d=i+"/"+this.application.key+"/"+this.cache.version+e.normalizePath(a)+".json";c.adapter.get(d,{},function(a,c,d){(!d||d.match(/xml/))&&(a="Not found"),a||!d?b(a,null):b(null,d)})},get:function(a,b,c,d){var e=this.normalizeParams(a,b,c,d);e.options.method="get",this.api(e.path,e.params,e.options,e.callback)},post:function(a,b,c,d){var e=this.normalizeParams(a,b,c,d);e.options.method="post",this.api(e.path,e.params,e.options,e.callback)},api:function(a,b,c,f){e.extend(b,{access_token:this.application.token});var g=this.application.getHost()+h+a,i=this,j=function(a,b,c){!a&&c?f(a,JSON.parse(c)):f(a,c)};"post"==c.method?i.adapter.post(g,b,j):!this.application.isInlineModeEnabled()&&c.cache_key&&this.cache?i.fetchReleaseVersion(function(a){i.cache.fetch(c.cache_key,function(a){i.fetchFromCdn(c.cache_key,function(c,e){e?a(c,e):i.adapter.get(g,b,function(b,c,e){b&&d.debug("api error: "+b),a(b,e)})})},function(a,b){if(!a&&b){try{b=JSON.parse(b)}catch(c){a=c,b=null}f(a,b)}else f(a,null)})}):i.adapter.get(g,b,j)}},b.exports=j},{"./api_adapters/base":12,"./configuration":17,"./logger":25,"./utils":40}],14:[function(a,b,c){var d=a("./utils"),e=a("./configuration"),f=a("./logger"),g=a("./language"),h=a("./source"),i=a("./api_client"),j="https://api.translationexchange.com",k=function(a){d.extend(this,a),this.languages=[];for(var b in a.languages||[])this.languages.push(new g(d.extend(b,{application:this})));this.default_locale=e.default_locale,this.languages_by_locale={},this.sources_by_key={},this.missing_keys_by_source={},this.translation_keys={}};k.prototype={getHost:function(){return this.host||j},extend:function(a){d.extend(this,a)},addLanguage:function(a){return a.application=this,this.languages_by_locale[a.locale]=new g(a),this.getLanguage(a.locale)},getLanguage:function(a){return this.languages_by_locale[a]},changeLanguage:function(a,b){var c=this;c.current_locale=a,c.sources_by_key={},this.initData([c.current_locale],[c.current_source],function(){b&&b(c.getLanguage(c.current_locale))})},getCurrentLanguage:function(){var a=this.current_locale;if(!a)return this.getLanguage(this.default_locale);var b=this.getLanguage(a);return b?b:(a=a.split("-")[0],b=this.getLanguage(a),b||this.getLanguage(this.default_locale))},addSource:function(a,b,c){return a?(a=new h({source:a}),a.application=this,a.updateTranslations(b,c),this.sources_by_key[a.source]=a,this.getSource(a.source)):void 0},getSource:function(a){return this.sources_by_key[a]},getCurrentSource:function(){return this.current_source?this.sources_by_key[this.current_source]:null},isFeatureEnabled:function(a){return this.features&&this.features[a]},getApiClient:function(){return this.api_client||(this.api_client=new i(this)),this.api_client},init:function(a,b){a=a||{};var c=this;c.current_translator=a.current_translator,c.current_source=a.current_source,c.getApiClient().get("projects/current/definition",{locale:a.current_locale||(a.accepted_locales?a.accepted_locales.join(","):"en"),source:a.current_source},{cache_key:"application"},function(d,e){if(d)throw console.log(d),d;c.extend(e),c.loadExtension(e),c.default_locale=c.default_locale||"en",c.current_locale=a.current_locale||c.getPreferredLocale(a.accepted_locales,c.languages)||c.default_locale;var f=[c.default_locale];c.current_locale!=c.default_locale&&f.push(c.current_locale);var g=[c.current_source||"index"];c.initData(f,g,b)})},loadExtension:function(a){if(a=a.extensions){var b=this,c=b.default_locale,d=e.getCache();b.isInlineModeEnabled()&&(d=null),a.languages&&Object.keys(a.languages).forEach(function(e){e!=b.default_locale&&(c=e),d&&d.store(b.getLanguageKey(e),JSON.stringify(a.languages[e])),b.addLanguage(new g(a.languages[e]))}),a.sources&&Object.keys(a.sources).forEach(function(e){d&&d.store(b.getSourceKey(e,c),JSON.stringify(a.sources[e])),b.addSource(e,c,a.sources[e])})}},initData:function(a,b,c){var d=this;d.loadLanguages(a,function(){b?d.loadSources(b,d.current_locale,function(a){a.length>0&&a[0]&&a[0].sources&&a[0].sources.length>0?d.loadSources(a[0].sources,d.current_locale,function(a){c(null)}):c(null)}):c(null)})},getPreferredLocale:function(a,b){var c,d=(b||[]).map(function(a){return a.locale});return(a||[]).forEach(function(a){var b=new RegExp(a+"|"+a.replace(/-\w+$/,""));d.forEach(function(a){!c&&a.match(b)&&(c=a)})}),c},loadLanguages:function(a,b){var c={},e=this;a.forEach(function(a){e.languages_by_locale[a]||(c[a]=function(b){e.getApiClient().get("languages/"+a,{definition:!0},{cache_key:e.getLanguageKey(a)},function(a,c){return a?void b(a,null):void b(null,new g(d.extend(c,{application:e})))})})}),d.parallel(c,function(a,c){if(a)throw console.log(a),a;Object.keys(c).forEach(function(a){e.addLanguage(c[a])}),b()})},getLanguageKey:function(a){return a+"/language"},getSourceKey:function(a,b){return b+"/sources/"+a},loadSources:function(a,b,c){var e={},f=this;a.forEach(function(a){f.sources_by_key[a]||(e[a]=function(c){var e=d.generateSourceKey(a);f.getApiClient().get("sources/"+e+"/translations",{locale:b,sources:!0,per_page:1e5},{cache_key:b+"/sources"+d.normalizePath(a)},function(a,b){return a?void c(a,null):void c(null,b)})})}),d.parallel(e,function(a,d){if(a)throw console.log(a),a;var e=[];Object.keys(d).forEach(function(a){e.push(d[a]),f.addSource(a,b,d[a])}),c(e)})},isInlineModeEnabled:function(){return this.current_translator?this.current_translator.inline:!1},addMissingElement:function(a,b){(!e.isFileCache()||this.isInlineModeEnabled())&&(this.missing_keys_by_source||(this.missing_keys_by_source={}),this.missing_keys_by_source[a]||(this.missing_keys_by_source[a]={}),null!==b&&(this.missing_keys_by_source[a][b.key]=b))},verifySourcePath:function(a,b){this.extensions&&this.extensions.sources&&null===this.extensions.sources[a]&&this.addMissingElement(b,null)},registerMissingTranslationKey:function(a,b){this.addMissingElement(a,b);var c=this;e.delayed_flush&&!c.submit_scheduled&&(c.submit_scheduled=!0,setTimeout(function(){c.submitMissingTranslationKeys()},3e3))},submitMissingTranslationKeys:function(a){if(!this.missing_keys_by_source)return void(a&&a(!1));if(!this.isInlineModeEnabled())return void(a&&a(!1));var b=d.keys(this.missing_keys_by_source);if(0===b.length)return void(a&&a(!1));f.debug("Submitting missing translation keys...");for(var c=[],g=["key","label","description","locale","level"],h=0;h<b.length;h++){for(var i=b[h],j=d.keys(this.missing_keys_by_source[i]),k=[],l=0;l<j.length;l++){for(var m=this.missing_keys_by_source[i][j[l]],n={},o=0;o<g.length;o++){var p=g[o];m[p]&&(n[p]=m[p])}k.push(n)}c.push({source:i,keys:k})}var q=this;q.missing_keys_by_source=null,this.getApiClient().post("sources/register_keys",{source_keys:JSON.stringify(c)},function(){d.keys(q.languages_by_locale).forEach(function(a){b.forEach(function(b){b=b.split(e.source_separator),b.forEach(function(b){e.getCache().del(a+"/sources/"+b,function(){})})})}),a&&a(!0)})},getTranslationKey:function(a){return this.translation_keys[a]},cacheTranslationKey:function(a){var b=this.getTranslationKey(a.key);if(b){for(var c=d.keys(a.translations||{}),e=0;e<c.length;e++){var f=a.translations[c[e]],g=this.getLanguage(c[e]);b.setTranslationsForLanguage(g,f)}return b}return a.setApplication(this),this.translation_keys[a.key]=a,a}},b.exports=k},{"./api_client":13,"./configuration":17,"./language":20,"./logger":25,"./source":29,"./utils":40}],15:[function(a,b,c){var d=a("./utils"),e=a("./cache_adapters/base"),f=function(b){this.adapter=null,this.options=b,this.version=b.version;var c;if(b){if("string"==typeof b.adapter){var f=a("./configuration");c=f.getCacheAdapter(b.adapter)}else"function"==typeof b.adapter&&(c=b.adapter,delete b.adapter);c&&(c.prototype=d.extend(new e,c.prototype),this.adapter=new c(b))}};f.prototype={fetch:function(a,b,c){return this.adapter?void this.adapter.fetch(a,b,c):void(d.isFunction(b)?b(function(a,b){b?c(null,b):c("no data",null)}.bind(this)):c(null,b))},store:function(a,b,c){return this.adapter?void this.adapter.store(a,b,c):void(d.isFunction(c)&&c())},del:function(a,b){return this.adapter?void this.adapter.del(a,b):void b()},exists:function(a,b){return this.adapter?void this.adapter.exists(a,b):void b()},fetchVersion:function(a){return this.adapter?void this.adapter.fetchVersion(a):void a(this.options.version||"0")},storeVersion:function(a,b){return this.version=a,this.adapter?void this.adapter.storeVersion(a,b):void(b&&b(a))},setVersion:function(a){this.version=a,this.adapter&&(this.adapter.version=a)},resetVersion:function(){this.adapter&&(this.version=null)},clear:function(a){return this.adapter?void this.adapter.clear(a):void(a&&a())}},b.exports=f},{"./cache_adapters/base":16,"./configuration":17,"./utils":40}],16:[function(a,b,c){var d=(a("../configuration"),a("../logger")),e=a("../utils"),f="current_version",g="tml",h=function(){};h.prototype={read_only:!0,cached_by_source:!0,name:"",initialize:function(a){this.config=a||{},this.cache=this.create()},create:function(){d.debug("Must be implemented by the extending class")},fetch:function(){d.debug("Must be implemented by the extending class")},store:function(a,b){d.debug("Must be implemented by the extending class")},del:function(a){d.debug("Must be implemented by the extending class")},exists:function(a){d.debug("Must be implemented by the extending class")},warn:function(a){d.debug(this.name+" - "+a)},info:function(a){d.debug(this.name+" - "+a)},fileName:function(a){return a+".json"},fetchDefault:function(a,b,c){var d=this;e.isFunction(b)?b(function(b,e){e?d.store(a,e,function(){c(null,e)}):c("no data",null)}.bind(this)):b&&d.store(a,b,function(a,b){c(null,b)})},fetchVersion:function(a){var b=this;b.config.version?(b.info("Cache version from config: "+b.config.version),a(b.config.version)):b.fetch(f,"undefined",function(c,d){b.info("Cache version: "+d),a(d)})},storeVersion:function(a,b){this.version=a,this.store(f,this.version,function(){b&&b(this.version)}.bind(this))},getVersionedKey:function(a){var b=[g,this.config.namespace||"",a==f?"v":"v"+(this.version||this.config.version||"0"),a];return b.join("_")},stripExtensions:function(a){return e.isString(a)&&a.match(/^\{/)&&(a=JSON.parse(a),a.extensions&&delete a.extensions,a=JSON.stringify(a)),a},getRequest:function(){return null},clear:function(a){a&&a(null)}},b.exports=h},{"../configuration":17,"../logger":25,"../utils":40}],17:[function(a,b,c){var d=a("./cache"),e=a("./utils"),f=a("./../config/config.js"),g=function(){e.merge(this,f)};g.prototype={initCache:function(a){return this.cache=this.cache||{},a&&(this.cache.namespace=a.substring(0,5)),this.cacheAdapter=new d(this.cache),this.cacheAdapter},getCache:function(){return this.cacheAdapter},getDefaultToken:function(a,b,c){if(b=b||"data",c=c||"html",this.default_tokens[c][b][a])return this.default_tokens[c][b][a];var d=a.split("_");return a=d[d.length-1],a=a.replace(/_*\d+$/,""),this.default_tokens[c][b][a]?this.default_tokens[c][b][a]:null},setDefaultToken:function(a,b,c,d){c=c||"data",d=d||"html",this.default_tokens[d]=this.default_tokens[d]||{},this.default_tokens[d][c]=this.default_tokens[d][c]||{},this.default_tokens[d][c][a]=b},getContextRules:function(a){return this.context_rules[a]||{}},setContextRules:function(a,b,c){return this.context_rules[a]?void(this.context_rules[a].variables[b]=c):!1},isDisabled:function(){return!this.isEnabled()},isEnabled:function(){return this.enabled},isFileCache:function(){return null===this.cache?!1:"file"==this.cache.adapter},registerCacheAdapter:function(a,b){this.cache_adapters=this.cache_adapters||{},this.cache_adapters[a]=b},registerCacheAdapters:function(a){var b=this;Object.keys(a).forEach(function(c){b.registerCacheAdapter(c,a[c])})},getCacheAdapter:function(a){return this.cache_adapters?this.cache_adapters[a]:null},registerApiAdapter:function(a,b){this.api_adapters=this.api_adapters||{},this.api_adapters[a]=b},registerApiAdapters:function(a){var b=this;Object.keys(a).forEach(function(c){b.registerApiAdapter(c,a[c][klass])})},getApiAdapter:function(a){return this.api_adapters?this.api_adapters[a]:null}},b.exports=new g},{"./../config/config.js":11,"./cache":15,"./utils":40}],18:[function(a,b,c){(function(c){var d=a("../utils"),e={isEnabled:function(a){return a?a.skip_decorations?!1:a.current_translator&&a.current_translator.inline:!1},getDecorationElement:function(a,b){return b.use_span?"span":b.use_div?"div":a},decorate:function(a,b,c,d,e){if(e=e||{},!this.isEnabled(e))return a;if(d.application&&d.application.isFeatureEnabled("lock_original_content")&&d.language==c||d.locked&&!e.current_translator.manager)return a;var f=this.getDecorationElement("tml:label",e),g=["tml_translatable"];if(e.locked){if(e.current_translator&&!e.current_translator.isFeatureEnabled("show_locked_keys"))return a;g.push("tml_locked")}else b.locale===d.locale?e.pending?g.push("tml_pending"):g.push("tml_not_translated"):b.locale===c.locale?g.push("tml_translated"):g.push("tml_fallback");var h=[];return h.push("<"+f+" class='"+g.join(" ")+"' data-translation_key='"+d.key+"' data-target_locale='"+c.locale+"'>"),h.push(a),h.push("</"+f+">"),h.join("")},decorateLanguageCase:function(a,b,e,f,g){if(g=g||{},!this.isEnabled(g))return f;for(var h={keyword:a.keyword,language_name:a.language.english_name,latin_name:a.latin_name,native_name:a.native_name,conditions:b?b.conditions:"",operations:b?b.operations:"",original:e,transformed:f},i=new c(JSON.stringify(h)).toString("base64").trim().replace("\n",""),j={"class":"tml_language_case","data-locale":a.language.locale,"data-rule":encodeURIComponent(i)},k=[],l=d.keys(j),m=0;m<l.length;m++)k.push(""+l[m]+'="'+j[l[m]]+'"');var n=this.getDecorationElement("tml:case",g),o=[];return o.push("<"+n+" "+k.join(" ")+">"),o.push(f),o.push("</"+n+">"),o.join("")},decorateToken:function(a,b,c){if(!this.isEnabled(c))return b;var d=this.getDecorationElement("tml:token",c),e=["tml_token","tml_token_"+a.getDecorationName()],f=[];return f.push("<"+d+" class='"+e.join(" ")+"' data-name='"+a.short_name+"'"),a.context_keys&&a.context_keys.length>0&&f.push(" data-context='"+a.context_keys.join(",")+"'"),a.case_keys&&a.case_keys.length>0&&f.push(" data-case='"+a.case_keys.join(",")+"'"),f.push(">"),f.push(b),f.push("</"+d+">"),f.join("")},decorateElement:function(a,b,c){if(!this.isEnabled(c))return b;var d=this.getDecorationElement("tml:element",c),e=[];return e.push("<"+d+">"),e.push(b),e.push("</"+d+">"),e.join("")}};b.exports=e}).call(this,a("buffer").Buffer)},{"../utils":40,buffer:7}],19:[function(a,b,c){var d={header:function(a,b){b=b||{};var c=[];if(c.push("<script>"),c.push("function tml_add_script(doc, id, src, onload) {"),c.push("  var script = doc.createElement('script');"),c.push("  script.setAttribute('id', id); script.setAttribute('type', 'application/javascript');"),c.push("  script.setAttribute('src', src);"),c.push("  script.setAttribute('charset', 'UTF-8');"),c.push("  if (onload) script.onload = onload;"),c.push("  doc.getElementsByTagName('head')[0].appendChild(script);"),c.push("  return script;"),c.push("}"),b.agent||(b.agent={type:"agent",cache:864e6}),"agent"==b.agent.type){var d=b.agent.host||"https://tools.translationexchange.com/agent/agent.min.js";if(b.agent.cache){var e=(new Date).getTime();e-=e%b.agent.cache,d+="?ts="+e}c.push("(function() {"),c.push("   tml_add_script(window.document, 'tml-agent', '"+d+"', function() {"),c.push("       Trex.init('"+a.key+"', "+JSON.stringify(b.agent)+");"),c.push("   });"),c.push("})();")}else{if(c.push("function tml_add_css(doc, value, inline) {"),c.push("  var css = null;"),c.push("  if (inline) {"),c.push("    css = doc.createElement('style'); css.type = 'text/css';"),c.push("    if (css.styleSheet) css.styleSheet.cssText = value;"),c.push("    else css.appendChild(document.createTextNode(value));"),c.push("  } else {"),c.push("    css = doc.createElement('link'); css.setAttribute('type', 'text/css');"),c.push("    css.setAttribute('rel', 'stylesheet'); css.setAttribute('media', 'screen');"),c.push("    css.setAttribute('href', value);"),c.push("  }"),c.push("  doc.getElementsByTagName('head')[0].appendChild(css);"),c.push("  return css;"),c.push("}"),c.push("(function() {"),c.push("  if (window.addEventListener) window.addEventListener('load', tml_init, false);"),c.push("  else if (window.attachEvent) window.attachEvent('onload', tml_init);"),c.push("  window.setTimeout(function() {tml_init();}, 1000);"),c.push("  function tml_init() {"),c.push("    if (window.tml_already_initialized) return;"),c.push("    window.tml_already_initialized = true;"),c.push("    tml_add_css(window.document, '"+a.tools.stylesheet+"', false);"),c.push('    tml_add_css(window.document, "'+a.css+'", true);'),c.push("    tml_add_script(window.document, 'tml-jssdk', '"+a.tools.javascript+"', function() {"),c.push("      Tml.app_key = '"+a.key+"';"),c.push("      Tml.host = '"+a.tools.host+"';"),
c.push("      Tml.current_source = '"+a.current_source+"';"),c.push("      Tml.default_locale = '"+a.default_locale+"';"),c.push("      Tml.page_locale = '"+b.current_language.locale+"';"),c.push("      Tml.locale = '"+b.current_language.locale+"';"),a.isFeatureEnabled("shortcuts"))for(var f=Object.keys(a.shortcuts||{}),g=0;g<f.length;g++)c.push("shortcut.add('"+f[g]+"', function() {"),c.push(a.shortcuts[f[g]]),c.push("});");c.push("      if (typeof(tml_on_ready) === 'function') tml_on_ready();"),c.push("      if (typeof(tml_footer_scripts) === 'function') tml_footer_scripts();"),c.push("    })"),c.push("  }"),c.push("})();")}return c.push("</script>"),c.join("\n")},language_selector_script_tag:function(){var a=[];return a.push("<script>"),a.push("function tml_change_locale(locale) {"),a.push("  var query_parts = window.location.href.split('#');"),a.push("  var anchor = query_parts.length > 1 ? query_parts[1] : null;"),a.push("  query_parts = query_parts[0].split('?');"),a.push("  var query = query_parts.length > 1 ? query_parts[1] : null;"),a.push("  var params = {};"),a.push("  if (query) {"),a.push("    var vars = query.split('&');"),a.push("    for (var i = 0; i < vars.length; i++) {"),a.push("      var pair = vars[i].split('=');"),a.push("      params[pair[0]] = pair[1];"),a.push("    }"),a.push("  }"),a.push("  params['locale'] = locale;"),a.push("  query = [];"),a.push("  var keys = Object.keys(params);"),a.push("  for (i = 0; i < keys.length; i++) {"),a.push("    query.push(keys[i] + '=' + params[keys[i]]);"),a.push("  }"),a.push("  var destination = query_parts[0];"),a.push("  if (query.length > 0)"),a.push("    destination = destination + '?' + query.join('&');"),a.push("  if (anchor)"),a.push("    destination = destination + '#' + anchor;"),a.push("  window.location = destination;"),a.push("}"),a.push("</script>"),a.join("")},language_name_tag:function(a,b){b=b||{},null===a&&(a=tml_current_language());var c=[];return b.flag&&(c.push(this.language_flag_tag(a)),c.push(" ")),c.push(a.native_name),c.join("")},language_flag_tag:function(a,b){b=b||{};var c=a.english_name;return"native"==b.language&&(c=a.native_name),null===a&&(a=tml_current_language()),"<img src='"+a.flag_url+"' style='margin-right:3px;' alt='"+c+"' title='"+c+"'>"},language_selector_toggle_method:function(){return"Tml.Utils.toggleInlineTranslations()"},language_selector_bootstrap:function(a,b){b=b||{};var c=b.element||"div",e=b.class_name||"dropdown",f=b.style||"",g=b.language||"english",h=b.toggle===!1?!1:!0,i=b.toggle_label||"Help Us Translate",j=b.toggle_label_cancel||"Disable translation mode",k=b.powered_by===!1?!1:!0,l=[];return b.client_side||l.push(this.language_selector_script_tag()),"none"!=c&&l.push("<"+c+" class='"+e+"' style='"+f+"'>"),l.push("  <a href='#' role='button' class='"+e+"-toggle' data-toggle='"+e+"'>"),l.push(d.language_name_tag(b.current_language,{flag:!0,name:g})),l.push("</a>"),l.push("<ul class='"+e+"-menu' role='menu'>"),a.languages.forEach(function(a){l.push("<li role='presentation'>"),b.current_language.locale==a.locale&&l.push("<div style='right: 5px;font-weight: bold;font-size: 16px;margin: 0px 5px 0px 0px;color: #13CF80;position: absolute;'>✓</div>"),b.client_side?l.push("<a href='javascript:void(0);' onclick='tml.changeLanguage(\""+a.locale+"\")'>"):l.push("<a href='javascript:void(0);' onclick='tml_change_locale(\""+a.locale+"\")'>"),l.push(d.language_name_tag(a,{flag:!0,name:g})),l.push("</a></li>")}),h&&(l.push("<li role='presentation' class='divider'></li>"),l.push("<li role='presentation'><a href='javascript:void(0);' onclick='"+this.language_selector_toggle_method()+"'>"),a.isInlineModeEnabled()?l.push(j):l.push(i),l.push("</a>"),l.push("</li>")),k&&(l.push("<li role='presentation' class='divider'></li>"),l.push("<div style='padding: 0px 20px; font-size:11px; white-space: nowrap;'>"),l.push("<a href='http://translationexchange.com' style='color:#888;'>"),l.push("Powered By Translation Exchange"),l.push("</a>"),l.push("</div>"),l.push("</ul>")),"none"!=c&&l.push("</"+c+">"),l.join("")},language_selector_default:function(a,b){b=b||{};var c=[];return c.push("<a href='#' onclick='Tml.UI.LanguageSelector.show();'>"),c.push("<img src='"+b.current_language.flag_url+"'> &nbsp;"),c.push(b.current_language.english_name),c.push("</a>"),c.join("")},language_selector_popup:function(a,b){b=b||{};var c=(b.element||"div",b.class_name||"dropdown",b.toggle===!1?!1:!0),e=b.toggle_label||"Help Us Translate",f=b.toggle_label_cancel||"Disable translation mode",g=b.powered_by===!1?!1:!0,h=b.name||"english",i=[];if(i.push("<style>"),i.push(".trex-language-selector {position: relative;display: inline-block;vertical-align: middle;}"),i.push(".trex-language-toggle,"),i.push(".trex-language-toggle:hover,"),i.push(".trex-language-toggle:focus {cursor:pointer;text-decoration:none;outline:none;}"),i.push(".trex-dropup .trex-dropdown-menu {top: auto;bottom: 100%;margin-bottom: 1px;-webkit-transform: scale(0.8) translateY(10%);transform: scale(0.8) translateY(10%);}"),i.push(".trex-dropleft .trex-dropdown-menu {left: auto; right: 0;}"),i.push(".trex-dropdown-menu {"),i.push("   -webkit-transform: scale(0.8) translateY(10%);transform: scale(0.8) translateY(10%);transition: 0.13s cubic-bezier(0.3, 0, 0, 1.3);opacity: 0;pointer-events: none;"),i.push("   display: block;font-family:Arial, sans-serif;position: absolute;"),i.push("   top: 100%;left: 0;z-index: 1000;float: left;list-style: none;background-color: #FFF;height:0px;width:0px;padding:0;overflow:hidden;"),i.push("}"),i.push(".trex-language-selector[dir=rtl] .trex-dropdown-menu {left: auto; right: 0;}"),i.push(".trex-language-selector.trex-dropleft[dir=rtl] .trex-dropdown-menu {left:0; right:auto;}"),i.push(".trex-language-selector.trex-open .trex-dropdown-menu {"),i.push("   opacity: 1;height:auto;width:auto;overflow:hidden;min-width: 250px;margin: 2px 0 0;font-size: 13px;"),i.push("   background-clip: padding-box;border: 1px solid rgba(0, 0, 0, 0.15);box-shadow: 0 2px 0 rgba(0, 0, 0, 0.05);"),i.push("   border-radius: 4px;color: #6D7C88;text-align: left;padding: 5px 0;"),i.push("   display:block;pointer-events: auto;-webkit-transform: none;transform: none;"),i.push("}"),i.push(".trex-dropdown-menu > li {"),i.push("text-align:"+b.current_language.align("left")+";"),i.push("}"),i.push(".trex-dropdown-menu > li > a {"),i.push("  display: block; text-decoration:none !important; padding: 3px 10px;margin:0 5px;clear: both;font-weight: normal;line-height: 1.42857143;color: #333;border-radius:3px;white-space: nowrap;cursor:pointer;"),i.push("}"),i.push(".trex-dropdown-menu > li > a .trex-flag {margin-right:3px;width:23px;}"),i.push(".trex-dropdown-menu > li.trex-language-item > a:hover,"),i.push(".trex-dropdown-menu > li.trex-language-item > a:focus {text-decoration:none !important;background: #F0F2F4;}"),i.push(".trex-dropdown-menu > li.trex-language-item > a .trex-native-name {font-size: 11px;color: #A9AFB8;margin-left: 3px;}"),i.push(".trex-dropdown-menu > li.trex-selected a:after {content: '✓';right: 5px;font-weight: bold;font-size: 16px;margin: 0px 5px 0px 0px;color: #13CF80;position: absolute;}"),i.push(".trex-dropdown-menu[dir=rtl] > li.trex-selected a:after {left: 5px; right:auto !important; margin: 0px 0 0px 5px;}"),i.push(".trex-dropdown-menu .trex-credit a {border-top: solid 1px #DDD;font-size: 13px;padding: 7px 0 0;margin: 5px 15px 5px;color: #9FA7AE;font-weight: 400;}"),i.push("</style>"),"self"==b.element?(b.container.className+=" trex-language-selector",b.container.dir=b.current_language.direction()):i.push("<"+b.element+" class='trex-language-selector' dir='"+b.current_language.direction()+"'>"),i.push("<a class='trex-language-toggle' data-toggle='tml-language-selector' tabindex='0' dir='"+b.current_language.direction()+"'>"),i.push(d.language_name_tag(b.current_language,{flag:!0,name:h})),i.push("</a>"),i.push("<ul class='trex-dropdown-menu' dir='"+b.current_language.direction()+"'>"),a.languages.forEach(function(a){i.push("<li class='trex-language-item "+(b.current_language.locale==a.locale?"trex-selected":"")+"' dir='"+b.current_language.direction()+"'>"),b.client_side?i.push("<a href='javascript:void(0);' onclick='tml.changeLanguage(\""+a.locale+"\")'>"):i.push("<a href='javascript:void(0);' onclick='tml_change_locale(\""+a.locale+"\")'>"),i.push(d.language_name_tag(a,{flag:!0,name:h})),i.push("</a></li>")}),c&&(i.push("<li class='trex-credit' dir='"+b.current_language.direction()+"'>"),i.push("<a href='javascript:void(0);' onclick='"+this.language_selector_toggle_method()+"'>"),a.isInlineModeEnabled()?i.push(f):i.push(e),i.push("</a>"),i.push("</li>")),g&&(i.push("<li class='trex-credit' dir='"+b.current_language.direction()+"'>"),i.push("<a href='http://translationexchange.com'>"),i.push("Powered by Translation Exchange"),i.push("</a>"),i.push("</li>")),i.push("</ul>"),"self"!=b.element&&i.push("</"+b.element+">"),!b.client_side){i.push(d.language_selector_script_tag()),i.push("<script>");var j=d.language_selector_popup_script.toString();j=j.substring(j.indexOf("// begin")+8,j.indexOf("// end")),i.push(j),i.push("</script>")}return i.join("\n")},language_selector_popup_script:function(){!function(){"use strict";function a(a,b,c){b.addEventListener?b.addEventListener(a,c,!1):b.attachEvent?b.attachEvent("on"+a,c):b[a]=c}function b(a,b){return a.className.match(new RegExp("(\\s|^)"+b+"(\\s|$)"))}function c(a,c){b(a,c)||(a.className+=" "+c)}function d(a,c){if(b(a,c)){var d=new RegExp("(\\s|^)"+c+"(\\s|$)");a.className=a.className.replace(d," ")}}var e=function(b){this.element=b,this.element.setAttribute("tabindex","0"),a("click",this.element,this.open.bind(this)),a("blur",this.element,this.close.bind(this))};e.VERSION="0.1.0",e.prototype={adjustMenu:function(a){d(a,"trex-dropup"),d(a,"trex-dropleft");var b=a.querySelectorAll(".trex-dropdown-menu")[0],e=b.getBoundingClientRect(),f=Math.max(document.documentElement.clientHeight,window.innerHeight||0),g=Math.max(document.documentElement.clientWidth,window.innerWidth||0),h=10;e.top+b.offsetHeight+h>f&&c(a,"trex-dropup"),e.left+b.offsetWidth+h>g&&c(a,"trex-dropleft")},open:function(a){a=a||window.event,a.stopPropagation(),a.preventDefault();var d=a.currentTarget||a.srcElement;return b(d.parentElement,"trex-open")?this.close(a):(c(d.parentElement,"trex-open"),this.adjustMenu(d.parentElement),!1)},close:function(a){a=a||window.event;var b=a.currentTarget||a.srcElement;setTimeout(function(){d(b.parentElement,"trex-open")},500)}};for(var f,g=document.querySelectorAll("[data-toggle=tml-language-selector]"),h=0,i=g.length;i>h;h++)f=g[h],f.languageSelector=new e(f)}()},language_selector_init:function(a,b,c){b=b||"default","popup"==b&&d.language_selector_popup_script()},language_selector_footer:function(a,b){b=b||{};var c=b.toggle===!1?!1:!0,d=b.toggle_label||"Help Us Translate",e=b.toggle_label_cancel||"Disable translation mode",f=b.powered_by===!1?!1:!0,g=[];return c&&(g.push("<div style='margin-top: 5px;' dir='"+b.current_language.direction()+"'>"),g.push("<a href='javascript:void(0);' onclick='"+this.language_selector_toggle_method()+"'>"),a.isInlineModeEnabled()?g.push(e):g.push(d),g.push("</a>"),g.push("</div>")),f&&(g.push("<div style='margin-top: 5px;' dir='ltr'>"),g.push("<a href='http://translationexchange.com' style='font-size:12px;color: #ccc;'>"),g.push("Powered by Translation Exchange"),g.push("</a>"),g.push("</div>")),g.join("")},language_selector_dropdown:function(a,b){b=b||{},b.style=b.style||"",b.class_name=b.class_name||"",b.name=b.name||"english";var c=[];b.client_side||c.push(this.language_selector_script_tag());var d="tml_change_locale(this.options[this.selectedIndex].value)";return b.client_side&&(d="tml.changeLanguage(this.options[this.selectedIndex].value)"),c.push("<select id='tml_language_selector' onchange='"+d+"' style='"+b.style+"' class='"+b.class_name+"'>"),a.languages.forEach(function(a){c.push("<option dir='ltr' value='"+a.locale+"' "+(b.current_language.locale==a.locale?"selected":"")+">"),"english"==b.name?c.push(a.english_name):c.push(a.native_name),c.push("</option>")}),c.push("</select>"),c.push(this.language_selector_footer(a,b)),c.join("")},language_selector_flags:function(a,b){b=b||{},b.style=b.style||"",b.class_name=b.class_name||"",b.name=b.name||"english";var c=this,d=[];return b.client_side||d.push(this.language_selector_script_tag()),d.push("<div id='tml_language_selector'  style='"+b.style+"' class='"+b.class_name+"'>"),a.languages.forEach(function(a){b.client_side?d.push("<a href='#' onclick=\"tml.changeLanguage('"+a.locale+"')\">"):d.push("<a href='#' onclick=\"tml_change_locale('"+a.locale+"')\">"),d.push(c.language_flag_tag(a,b)),d.push("</a> ")}),d.push(this.language_selector_footer(a,b)),d.push("</div>"),d.join("")},language_selector_list:function(a,b){b=b||{},b.style=b.style||"",b.class_name=b.class_name||"",b.name=b.name||"english",b.flag=!0;var c=this,d=[];return b.client_side||d.push(this.language_selector_script_tag()),d.push("<div id='tml_language_selector'  style='"+b.style+"' class='"+b.class_name+"'>"),a.languages.forEach(function(a){d.push("<div>"),b.current_language.locale==a.locale&&(d.push("<div style='float:right; font-weight: bold;font-size: 16px;'>✓</div>"),d.push("<strong>")),b.client_side?d.push("<a href='#' onclick=\"tml.changeLanguage('"+a.locale+"')\">"):d.push("<a href='#' onclick=\"tml_change_locale('"+a.locale+"')\">"),d.push(c.language_name_tag(a,b)),d.push("</a>"),b.current_language.locale==a.locale&&d.push("</strong>"),d.push("</div>")}),d.push(this.language_selector_footer(a,b)),d.push("</div>"),d.join("")},language_selector:function(a,b,c){return b=b||"default","default"==b?d.language_selector_default(a,c):"bootstrap"==b?d.language_selector_bootstrap(a,c):"popup"==b?d.language_selector_popup(a,c):"dropdown"==b?d.language_selector_dropdown(a,c):"flags"==b?d.language_selector_flags(a,c):"list"==b?d.language_selector_list(a,c):""}};b.exports={header:d.header,language_name_tag:d.language_name_tag,language_flag_tag:d.language_flag_tag,language_selector:d.language_selector,language_selector_init:d.language_selector_init}},{}],20:[function(a,b,c){var d=a("./utils"),e=a("./configuration"),f=a("./language_context"),g=a("./language_case"),h=a("./translation_key"),i=function(a){d.extend(this,a),this.contexts={};for(var b=d.keys(a.contexts||{}),c=0;c<b.length;c++)this.contexts[b[c]]=new f(d.extend(a.contexts[b[c]],{language:this,keyword:b[c]}));for(this.cases={},b=d.keys(a.cases||{}),c=0;c<b.length;c++)this.cases[b[c]]=new g(d.extend(a.cases[b[c]],{language:this,keyword:b[c]}))};i.prototype={getContextByKeyword:function(a){return this.contexts[a]},getContextByTokenName:function(a){for(var b=d.keys(this.contexts||{}),c=0;c<b.length;c++)if(this.contexts[b[c]].isAppliedToToken(a))return this.contexts[b[c]];return null},getLanguageCaseByKeyword:function(a){return this.cases[a]},isDefault:function(){return this.locale==e.default_locale},translate:function(a,b,c,f){var g=d.normalizeParams(a,b,c,f),i=new h({label:g.label,description:g.description,language:this.application?this.application.getLanguage():null,application:this.application});if(this.application){var j=this.getSourcePath(g.options),k=j[j.length-1];j=j.join(e.source_separator),g.options.block_options&&g.options.block_options.dynamic?j=k:this.application.verifySourcePath(k,j);var l=this.application.getSource(k),m=l?l.getTranslations(this.locale,i.key):null;if(m)i.setTranslations(this.locale,m);else{g.options.pending=!0,this.application.registerMissingTranslationKey(j,i);var n=this.application.getTranslationKey(i.key);n&&(i=n)}}return i.translate(this,g.tokens,g.options)},align:function(a){return this.isRightToLeft()?"left"==a?"right":"left":a},isRightToLeft:function(){return this.right_to_left},direction:function(){return this.isRightToLeft()?"rtl":"ltr"},getSourcePath:function(a){if(!a.block_options)return[a.current_source];for(var b=[],c=0;c<a.block_options.length;c++){var d=a.block_options[c];d.source&&b.push(d.source)}return b=b.reverse(),b.unshift(a.current_source),b}},b.exports=i},{"./configuration":17,"./language_case":21,"./language_context":23,"./translation_key":38,"./utils":40}],21:[function(a,b,c){var d=a("./utils"),e=a("./configuration"),f=a("./language_case_rule"),g=a("./decorators/html"),h=function(a){d.extend(this,a),this.rules=[],a.rules=a.rules||[];for(var b=0;b<a.rules.length;b++)this.rules.push(new f(d.extend(a.rules[b],{language_case:this})))};h.prototype={findMatchingRule:function(a,b){for(var c=0;c<this.rules.length;c++){var d=this.rules[c];if(d.evaluate(a,b))return d}return null},apply:function(a,b,c){var e=d.unique(a.match(/<\/?[^>]*>/g)||[]),f=a.replace(/<\/?[^>]*>/g,""),h=[f];"phrase"!=this.application&&(h=d.unique(f.split(/[\s\/]/)||[]));for(var i=0;i<e.length;i++)a=a.replace(e[i],"{$h"+i+"}");for(i=0;i<h.length;i++)a=a.replace(h[i],"{$w"+i+"}");var j=g,k=[];for(i=0;i<h.length;i++){var l=h[i],m=this.findMatchingRule(l,b),n=m?m.apply(l):l;k.push(j.decorateLanguageCase(this,m,l,n,c))}for(i=0;i<h.length;i++)a=a.replace("{$w"+i+"}",k[i]);for(i=0;i<e.length;i++)a=a.replace("{$h"+i+"}",e[i]);return a},getConfig:function(){return e}},b.exports=h},{"./configuration":17,"./decorators/html":18,"./language_case_rule":22,"./utils":40}],22:[function(a,b,c){var d=a("./utils"),e=a("./rules_engine/parser"),f=a("./rules_engine/evaluator"),g=function(a){d.extend(this,a)};g.prototype={getConditionsExpression:function(){return this.conditions_expression||(this.conditions_expression=new e(this.conditions).parse()),this.conditions_expression},getOperationsExpression:function(){return this.operations_expression||(this.operations_expression=new e(this.operations).parse()),this.operations_expression},getGenderVariables:function(a){if(-1==this.conditions.indexOf("@gender"))return{};if(!a)return{gender:"unknown"};var b=this.language_case.language.getContextByKeyword("gender");return b?b.getVars(a):{gender:"unknown"}},evaluate:function(a,b){if(!this.conditions)return!1;var c=new f;return c.setVars(d.extend({"@value":a},this.getGenderVariables(b))),c.evaluate(this.getConditionsExpression())},apply:function(a){if(!this.operations)return a;var b=new f;return b.setVars({"@value":a}),b.evaluate(this.getOperationsExpression())}},b.exports=g},{"./rules_engine/evaluator":27,"./rules_engine/parser":28,"./utils":40}],23:[function(a,b,c){var d=a("./utils"),e=a("./configuration"),f=a("./language_context_rule"),g=function(a){d.extend(this,a),this.rules={};for(var b=d.keys(a.rules||{}),c=0;c<b.length;c++)this.rules[b[c]]=new f(d.extend(a.rules[b[c]],{language_context:this,keyword:b[c]}))};g.prototype={isAppliedToToken:function(a){var b=new RegExp(this.token_expression.substring(1,this.token_expression.length-2));return null!==a.match(b)},getFallbackRule:function(){if(!this.fallback_rule)for(var a=d.keys(this.rules),b=0;b<a.length;b++){var c=a[b];this.rules[c].isFallback()&&(this.fallback_rule=this.rules[c])}return this.fallback_rule},getConfig:function(){return e.getContextRules(this.keyword)},getVars:function(a){for(var b={},c=this.getConfig(),d=0;d<this.variables.length;d++){var e=this.variables[d];if(c.variables&&c.variables[e]){var f=c.variables[e];"string"==typeof f?(a.object&&(a=a.object),b[e]=a[f]):"function"==typeof f?b[e]=f(a):b[e]=a}else b[e]=a}return b},findMatchingRule:function(a){for(var b=this.getVars(a),c=d.keys(this.rules),e=0;e<c.length;e++){var f=this.rules[c[e]];if(!f.isFallback()&&f.evaluate(b))return f}return this.getFallbackRule()}},b.exports=g},{"./configuration":17,"./language_context_rule":24,"./utils":40}],24:[function(a,b,c){var d=a("./utils"),e=a("./rules_engine/parser"),f=a("./rules_engine/evaluator"),g=function(a){d.extend(this,a)};g.prototype={isFallback:function(){return"other"==this.keyword},getConditionsExpression:function(){return this.conditions_expression||(this.conditions_expression=new e(this.conditions).parse()),this.conditions_expression},evaluate:function(a){if(this.isFallback())return!0;var b=new f;return b.setVars(a||{}),b.evaluate(this.getConditionsExpression())}},b.exports=g},{"./rules_engine/evaluator":27,"./rules_engine/parser":28,"./utils":40}],25:[function(a,b,c){var d=(a("./utils"),{formatDate:function(a){var b=a.getHours(),c=a.getMinutes(),d=a.getSeconds();b%=12,b=b?b:12,c=10>c?"0"+c:c;var e=b+":"+c+":"+d;return a.getMonth()+1+"/"+a.getDate()+"/"+a.getFullYear()+" "+e},log:function(b,c){var d=a("./configuration");if(d.debug){var e="tml: "+b;c&&(e=e+" "+JSON.stringify(c)),console.log(e)}},debug:function(a,b){this.log(a,b)}});b.exports=d},{"./configuration":17,"./utils":40}],26:[function(a,b,c){var d=function(a){function b(a,b){return a<<b|a>>>32-b}function c(a,b){var c,d,e,f,g;return e=2147483648&a,f=2147483648&b,c=1073741824&a,d=1073741824&b,g=(1073741823&a)+(1073741823&b),c&d?2147483648^g^e^f:c|d?1073741824&g?3221225472^g^e^f:1073741824^g^e^f:g^e^f}function d(a,b,c){return a&b|~a&c}function e(a,b,c){return a&c|b&~c}function f(a,b,c){return a^b^c}function g(a,b,c){return b^(a|~c)}function h(a,e,f,g,h,i,j){return a=c(a,c(c(d(e,f,g),h),j)),c(b(a,i),e)}function i(a,d,f,g,h,i,j){return a=c(a,c(c(e(d,f,g),h),j)),c(b(a,i),d)}function j(a,d,e,g,h,i,j){return a=c(a,c(c(f(d,e,g),h),j)),c(b(a,i),d)}function k(a,d,e,f,h,i,j){return a=c(a,c(c(g(d,e,f),h),j)),c(b(a,i),d)}function l(a){for(var b,c=a.length,d=c+8,e=(d-d%64)/64,f=16*(e+1),g=Array(f-1),h=0,i=0;c>i;)b=(i-i%4)/4,h=i%4*8,g[b]=g[b]|a.charCodeAt(i)<<h,i++;return b=(i-i%4)/4,h=i%4*8,g[b]=g[b]|128<<h,g[f-2]=c<<3,g[f-1]=c>>>29,g}function m(a){var b,c,d="",e="";for(c=0;3>=c;c++)b=a>>>8*c&255,e="0"+b.toString(16),d+=e.substr(e.length-2,2);return d}function n(a){a=a.replace(/\r\n/g,"\n");for(var b="",c=0;c<a.length;c++){var d=a.charCodeAt(c);128>d?b+=String.fromCharCode(d):d>127&&2048>d?(b+=String.fromCharCode(d>>6|192),b+=String.fromCharCode(63&d|128)):(b+=String.fromCharCode(d>>12|224),b+=String.fromCharCode(d>>6&63|128),b+=String.fromCharCode(63&d|128))}return b}var o,p,q,r,s,t,u,v,w,x=Array(),y=7,z=12,A=17,B=22,C=5,D=9,E=14,F=20,G=4,H=11,I=16,J=23,K=6,L=10,M=15,N=21;for(a=n(a),x=l(a),t=1732584193,u=4023233417,v=2562383102,w=271733878,o=0;o<x.length;o+=16)p=t,q=u,r=v,s=w,t=h(t,u,v,w,x[o+0],y,3614090360),w=h(w,t,u,v,x[o+1],z,3905402710),v=h(v,w,t,u,x[o+2],A,606105819),u=h(u,v,w,t,x[o+3],B,3250441966),t=h(t,u,v,w,x[o+4],y,4118548399),w=h(w,t,u,v,x[o+5],z,1200080426),v=h(v,w,t,u,x[o+6],A,2821735955),u=h(u,v,w,t,x[o+7],B,4249261313),t=h(t,u,v,w,x[o+8],y,1770035416),w=h(w,t,u,v,x[o+9],z,2336552879),v=h(v,w,t,u,x[o+10],A,4294925233),u=h(u,v,w,t,x[o+11],B,2304563134),t=h(t,u,v,w,x[o+12],y,1804603682),w=h(w,t,u,v,x[o+13],z,4254626195),v=h(v,w,t,u,x[o+14],A,2792965006),u=h(u,v,w,t,x[o+15],B,1236535329),t=i(t,u,v,w,x[o+1],C,4129170786),w=i(w,t,u,v,x[o+6],D,3225465664),v=i(v,w,t,u,x[o+11],E,643717713),u=i(u,v,w,t,x[o+0],F,3921069994),t=i(t,u,v,w,x[o+5],C,3593408605),w=i(w,t,u,v,x[o+10],D,38016083),v=i(v,w,t,u,x[o+15],E,3634488961),u=i(u,v,w,t,x[o+4],F,3889429448),t=i(t,u,v,w,x[o+9],C,568446438),w=i(w,t,u,v,x[o+14],D,3275163606),v=i(v,w,t,u,x[o+3],E,4107603335),u=i(u,v,w,t,x[o+8],F,1163531501),t=i(t,u,v,w,x[o+13],C,2850285829),w=i(w,t,u,v,x[o+2],D,4243563512),v=i(v,w,t,u,x[o+7],E,1735328473),u=i(u,v,w,t,x[o+12],F,2368359562),t=j(t,u,v,w,x[o+5],G,4294588738),w=j(w,t,u,v,x[o+8],H,2272392833),v=j(v,w,t,u,x[o+11],I,1839030562),u=j(u,v,w,t,x[o+14],J,4259657740),t=j(t,u,v,w,x[o+1],G,2763975236),w=j(w,t,u,v,x[o+4],H,1272893353),v=j(v,w,t,u,x[o+7],I,4139469664),u=j(u,v,w,t,x[o+10],J,3200236656),t=j(t,u,v,w,x[o+13],G,681279174),w=j(w,t,u,v,x[o+0],H,3936430074),v=j(v,w,t,u,x[o+3],I,3572445317),u=j(u,v,w,t,x[o+6],J,76029189),t=j(t,u,v,w,x[o+9],G,3654602809),w=j(w,t,u,v,x[o+12],H,3873151461),v=j(v,w,t,u,x[o+15],I,530742520),u=j(u,v,w,t,x[o+2],J,3299628645),t=k(t,u,v,w,x[o+0],K,4096336452),w=k(w,t,u,v,x[o+7],L,1126891415),v=k(v,w,t,u,x[o+14],M,2878612391),u=k(u,v,w,t,x[o+5],N,4237533241),t=k(t,u,v,w,x[o+12],K,1700485571),w=k(w,t,u,v,x[o+3],L,2399980690),v=k(v,w,t,u,x[o+10],M,4293915773),u=k(u,v,w,t,x[o+1],N,2240044497),t=k(t,u,v,w,x[o+8],K,1873313359),w=k(w,t,u,v,x[o+15],L,4264355552),v=k(v,w,t,u,x[o+6],M,2734768916),u=k(u,v,w,t,x[o+13],N,1309151649),t=k(t,u,v,w,x[o+4],K,4149444226),w=k(w,t,u,v,x[o+11],L,3174756917),v=k(v,w,t,u,x[o+2],M,718787259),u=k(u,v,w,t,x[o+9],N,3951481745),t=c(t,p),u=c(u,q),v=c(v,r),w=c(w,s);var O=m(t)+m(u)+m(v)+m(w);return O.toLowerCase()};b.exports=d},{}],27:[function(a,b,c){var d=function(a){return this.vars={},this.ctx=a||{label:function(a,b){return this.vars[a]=this.ctx[a]=b,b},quote:function(a){return a},car:function(a){return a[1]},cdr:function(a){return a.shift(),a},cons:function(a,b){return b.unshift(a),b},eq:function(a,b){return a==b},atom:function(a){return!(typeof a in{object:1,array:1,"function":1})},cond:function(a,b,c){return this.evaluate(a)?this.evaluate(b):this.evaluate(c)},set:function(a,b){return this.vars[a]=this.ctx[a]=b,b},"=":function(a,b){return a==b},"!=":function(a,b){return a!=b},"<":function(a,b){return b>a},">":function(a,b){return a>b},"+":function(a,b){return a+b},"-":function(a,b){return a-b},"*":function(a,b){return a*b},"%":function(a,b){return a%b},mod:function(a,b){return a%b},"/":function(a,b){return 1*a/b},"!":function(a){return!a},not:function(a){return!a},"&&":function(){return Array.prototype.slice.call(arguments).every(this.evaluate.bind(this))},and:function(){return Array.prototype.slice.call(arguments).every(this.evaluate.bind(this))},"||":function(){return!!Array.prototype.slice.call(arguments).filter(this.evaluate.bind(this)).length},or:function(){return!!Array.prototype.slice.call(arguments).filter(this.evaluate.bind(this)).length},"if":function(a,b,c){return this.evaluate(a)?this.evaluate(b):this.evaluate(c)},let:function(a,b){return this.vars[a]=b,b},"true":function(){return!0},"false":function(){return!1},date:function(a){return new Date(a)},today:function(){return new Date},time:function(a){return new Date(a)},now:function(){return Date.now()},append:function(a,b){return String(b)+String(a)},prepend:function(a,b){return String(a)+String(b)},match:function(a,b){return a=this._stringToRegexp(a),!!b.match(a)},"in":function(a,b){var c,d=this._range;return a=a.replace(/\s/g,"").replace(/(\w+)\.\.(\w+)/g,function(a,b,e){return c=d(b,e),c.push(e),c.join()}),-1!=a.split(",").indexOf(String(b))},within:function(a,b){var c=a.split("..").map(function(a){return parseInt(a)});return c[0]<=b&&b<=c[1]},replace:function(a,b,c){return a=this._stringToRegexp(a),c.replace(a,b)},count:function(a){return("string"==typeof a?this.vars[a]:a).length},all:function(a,b){return a="string"==typeof a?this.vars[a]:a,a instanceof Array?a.every(function(a){return a==b}):!1},any:function(a,b){return a="string"==typeof a?this.vars[a]:a,a instanceof Array?!!a.filter(function(a){return a==b}):!1}},this};d.prototype={_range:function(a,b){var c=[],d=!String(a).match(/^\d+$/);for(a=d?a.charCodeAt(0):parseInt(a),b=d?b.charCodeAt(0):parseInt(b);b>=a;)c.push(d?String.fromCharCode(a):String(a)),a+=1;return c},_stringToRegexp:function(a){var b=new RegExp("^/","g");return a.match(b)?(a=a.replace(b,""),a.match(/\/i$/)?(a=a.replace(/\/i$/g,""),new RegExp(a,"ig")):(a=a.replace(/\/$/,""),new RegExp(a,"g"))):new RegExp(a,"g")},setVars:function(a){this.vars=a},getVars:function(){return this.vars},apply:function(a,b){return"function"==typeof this.ctx[a]?this.ctx[a].apply(this,b):this.ctx[a]},evaluate:function(a){if(this.ctx.atom.call(this,a))return"string"==typeof a&&this.vars[a]?this.vars[a]:a in this.ctx?this.ctx[a]:a;var b=a[0],c=a.slice(1);return-1==["quote","car","cdr","cond","if","&&","||","and","or","true","false","let","count","all","any"].indexOf(b)&&(c=c.map(this.evaluate.bind(this))),this.apply(b,c)}},b.exports=d},{}],28:[function(a,b,c){var d=function(a){this.tokenize(a)};d.prototype={tokenize:function(a){this.tokens=a.match(/[()]|\w+|@\w+|[\+\-\!\|\=>&<\*\/%]+|\".*?\"|'.*?'/g)},parse:function(){return token=this.tokens.shift(),token?"("==token?this.parseList():token.match(/^['"].*/)?token.slice(1,-1):token.match(/\d+/)?parseInt(token):String(token):void 0},parseList:function(){for(var a=[];this.tokens.length>0&&")"!=this.tokens[0];)a.push(this.parse());return this.tokens.shift(),a}},b.exports=d},{}],29:[function(a,b,c){var d=a("./utils"),e=(a("./configuration"),a("./translation")),f=function(a){d.extend(this,a),this.key=d.generateSourceKey(a.source),this.translations={}};f.prototype={getTranslations:function(a,b){return this.translations[a]?this.translations[a][b]:null},updateTranslations:function(a,b){b=b&&b.results?b.results:b;var c=d.keys(b);this.translations[a]=this.translations[a]||[];for(var f=0;f<c.length;f++){var g=c[f];this.translations[a][g]=[];var h=b[g];!d.isArray(h)&&h.translations&&(h=h.translations);for(var i=0;i<h.length;i++){var j=h[i];this.translations[a][g].push(new e({locale:j.locale||a,label:j.label,locked:j.locked,context:j.context}))}}}},b.exports=f},{"./configuration":17,"./translation":37,"./utils":40}],30:[function(a,b,c){var d=a("./utils"),e=a("./configuration"),f=a("./logger"),g={version:"0.4.2",Application:a("./application"),Language:a("./language"),LanguageContext:a("./language_context"),LanguageContextRule:a("./language_context_rule"),LanguageCase:a("./language_case"),LanguageCaseRule:a("./language_case_rule"),TranslationKey:a("./translation_key"),Translation:a("./translation"),Translator:a("./translator"),Source:a("./source"),DomTokenizer:a("./tokenizers/dom"),ApiAdapterBase:a("./api_adapters/base"),CacheAdapterBase:a("./cache_adapters/base"),logger:f,utils:d,config:e,scripts:a("./helpers/scripts"),init:function(a){d.merge(e,a),e.initCache()},translate:function(a,b,c,d){var f=this.application.getLanguage(e.current_locale);return f=f||this.application.getLanguage(e.default_locale),f.translate(a,b,c,d)},configure:function(a){a(e)},cache:function(a){var b=e.cache.data||{};b.languages=b.languages||{},b.sources=b.sources||{},e.cache.data=b,a(e.cache.data)}};b.exports=g},{"./api_adapters/base":12,"./application":14,"./cache_adapters/base":16,"./configuration":17,"./helpers/scripts":19,"./language":20,"./language_case":21,"./language_case_rule":22,"./language_context":23,"./language_context_rule":24,"./logger":25,"./source":29,"./tokenizers/dom":33,"./translation":37,"./translation_key":38,"./translator":39,"./utils":40}],31:[function(a,b,c){var d=(a("../configuration"),a("../tokens/data")),e=a("../tokens/method"),f=a("../tokens/piped"),g=function(a){this.label=a,this.tokenize()};g.prototype={tokenize:function(){this.tokens=[];for(var a=this.getSupportedTokens(),b=""+this.label,c=0;c<a.length;c++){for(var d=a[c],e=b.match(d[0])||[],f=0;f<e.length;f++)this.tokens.push(new d[1](e[f],this.label));b=b.replace(a[c][0],"")}},getSupportedTokens:function(){return[[/(%?\{{1,2}\s*\w*\s*(:\s*\w+)*\s*(::\s*\w+)*\s*\}{1,2})/g,d],[/(%?\{{1,2}\s*[\w]*\.\w*\s*(:\s*\w+)*\s*(::\s*\w+)*\s*\}{1,2})/g,e],[/(%?\{{1,2}\s*[\w]*\s*(:\s*\w+)*\s*\|\|?[^\{\}\|]+\}{1,2})/g,f]]},isTokenAllowed:function(a,b){return b.allowed_tokens?-1!=b.allowed_tokens.indexOf(a):!0},substitute:function(a,b,c){c=c||{};for(var d=this.label,e=0;e<this.tokens.length;e++){var f=this.tokens[e];this.isTokenAllowed(f.name,c)&&(d=f.substitute(d,b,a,c))}return d}},b.exports=g},{"../configuration":17,"../tokens/data":34,"../tokens/method":35,"../tokens/piped":36}],32:[function(a,b,c){var d=a("../utils"),e=a("../configuration"),f="tml",g="\\[[\\w]*:",h="\\]",i="\\[[\\w]*\\]",j="\\[\\/[\\w]*\\]",k="<[^\\>]*>",l="<\\/[^\\>]*>",m="[^\\[\\]<>]+",n="short",o="long",p="html",q="{$0}",r=function(a){this.label="["+f+"]"+a+"[/"+f+"]",this.fragments=[],this.tokens=[],this.tokenize()};r.prototype={tokenize:function(){var a=[g,h,i,j,k,l,m].join("|");return a=new RegExp(a,"g"),this.fragments=this.label.match(a),this.fragments},peek:function(){return 0===this.fragments.length?null:this.fragments[0]},getNextFragment:function(){return 0===this.fragments.length?null:this.fragments.shift()},parse:function(){var a=this.getNextFragment();
return a.match(new RegExp(g))?this.parseTree(a.replace(/[\[:]/g,""),n):a.match(new RegExp(i))?this.parseTree(a.replace(/[\[\]]/g,""),o):a.match(new RegExp(k))?-1!=a.indexOf("/>")?a:this.parseTree(a.replace(/[<>]/g,"").split(" ")[0],p):a},parseTree:function(a,b){var c=[a];if(-1==this.tokens.indexOf(a)&&a!=f&&this.tokens.push(a),b==n)for(var d=!0;null!==this.peek()&&!this.peek().match(new RegExp(h));){var e=this.parse();d&&"string"==typeof e&&(e=e.replace(/^\s+/,""),d=!1),c.push(e)}else if(b==o)for(;null!==this.peek()&&!this.peek().match(new RegExp(j));)c.push(this.parse());else if(b==p)for(;null!==this.peek()&&!this.peek().match(new RegExp(l));)c.push(this.parse());return this.getNextFragment(),c},isTokenAllowed:function(a){return!this.options.allowed_tokens||-1!=this.options.allowed_tokens.indexOf(a)},getDefaultDecoration:function(a,b){var c=e.getDefaultToken(a,"decoration");if(null===c)return"<"+a+">"+b+"</"+a+">";var f=this.context[a];if(c=c.replace(q,b),d.isObject(f)){for(var g=d.keys(f),h=0;h<g.length;h++)c=c.replace("{$"+g[h]+"}",f[g[h]]);c=c.replace(/[\w]*=['"]\{\$[^\}]*\}['"]/g,"").replace(/\s*>/,">").trim()}return c},apply:function(a,b){if(a==f)return b;if(!this.isTokenAllowed(a))return b;var c=this.context[a];return c?"string"==typeof c?c.replace(q,b):"function"==typeof c?c(b):"object"==typeof c?this.getDefaultDecoration(a,b):b:this.getDefaultDecoration(a,b)},evaluate:function(a){if(!(a instanceof Array))return a;var b=a[0];a.shift();for(var c=this,d=[],e=0;e<a.length;e++)d.push(c.evaluate(a[e]));return this.apply(b,d.join(""))},substitute:function(a,b){this.context=a||{},this.options=b||{};var c=this.evaluate(this.parse());return c=c.replace("[/tml]","")}},b.exports=r},{"../configuration":17,"../utils":40}],33:[function(a,b,c){var d=a("../utils"),e=a("../configuration"),f=function(a,b,c){this.doc=a,this.context=b||{},this.tokens=[],this.options=c||{}};f.prototype={translate:function(){return this.translateTree(this.doc)},translateTree:function(a){if(this.isNonTranslatableNode(a))return a.innerHTML;if(3==a.nodeType)return this.translateTml(a.nodeValue);for(var b="",c="",d=0;d<a.childNodes.length;d++){var e=a.childNodes[d];if(3==e.nodeType)c+=e.nodeValue;else if(this.isInlineNode(e)&&this.hasInlineOrTextSiblings(e)&&!this.isBetweenSeparators(e))c+=this.generateTmlTags(e);else if(this.isSeparatorNode(e))""!==c&&(b+=this.translateTml(c)),b+=this.generateHtmlToken(e),c="";else{""!==c&&(b+=this.translateTml(c));var f=this.translateTree(e);b+=this.isIgnoredNode(e)?f:this.generateHtmlToken(e,f),c=""}}return""!==c&&(b+=this.translateTml(c)),b},isNoTranslate:function(a){if(a.attributes)for(var b=0;b<a.attributes.length;b++){if("notranslate"==a.attributes[b].name)return!0;if("class"==a.attributes[b].name&&-1!=a.attributes[b].value.indexOf("notranslate"))return!0}return!1},isNonTranslatableNode:function(a){if(!a)return!1;if(8==a.nodeType)return!0;if(1==a.nodeType){if(-1!=this.getOption("nodes.scripts").indexOf(a.nodeName.toLowerCase()))return!0;if(0===a.childNodes.length&&""===a.nodeValue)return!0;if(this.isNoTranslate(a))return!0}return!1},translateTml:function(a){if(this.isEmptyString(a))return a;a=this.generateDataTokens(a);var b=this.options.current_language||e.currentLanguage;if(this.getOption("split_sentences")){sentences=d.splitSentences(a),translation=a;var c=this;return sentences.forEach(function(a){var d=c.getOption("debug")?c.debugTranslation(a):b.translate(a,c.tokens,c.options);translation=translation.replace(a,d)}),this.resetContext(),translation}return a=a.replace(/[\n]/g,"").replace(/\s\s+/g," ").trim(),translation=this.getOption("debug")?this.debugTranslation(a):b.translate(a,this.tokens,this.options),this.resetContext(),translation},hasChildNodes:function(a){return a.childNodes?a.childNodes.length>0:!1},isBetweenSeparators:function(a){return this.isSeparatorNode(a.previousSibling)&&!this.isValidTextNode(a.nextSibling)?!0:this.isSeparatorNode(a.nextSibling)&&!this.isValidTextNode(a.previousSibling)?!0:!1},generateTmlTags:function(a){var b="",c=this;if(this.isNoTranslate(a)){var d=this.contextualize(this.adjustName(a),a.innerHTML);return"{"+d+"}"}var e=a.tagName.toLowerCase();if("var"==e)return this.registerDataTokenFromVar(a);for(var f=0;f<a.childNodes.length;f++){var g=a.childNodes[f];b+=3==g.nodeType?g.nodeValue:c.generateTmlTags(g)}var h=c.generateHtmlToken(a),i=this.contextualize(this.adjustName(a),h),j=this.sanitizeValue(b);return this.isSelfClosingNode(a)?"{"+i+"}":this.isShortToken(i,j)?"["+i+": "+j+"]":"["+i+"]"+j+"[/"+i+"]"},registerDataTokenFromVar:function(a){var b={},c="var";if(a.attributes)for(var d=0;d<a.attributes.length;d++){var e=a.attributes[d];""===e.value?c=e.name:b[e.name]=e.value}return b.value=b.value||a.innerHTML,c=this.contextualize(c,a.innerHTML),"{"+c+"}"},getOption:function(a){return"undefined"==typeof this.options[a]||null===this.options[a]?d.hashValue(e.translator_options,a):this.options[a]},debugTranslation:function(a){return this.getOption("debug_format").replace("{$0}",a)},isEmptyString:function(a){return a=a.replace(/[\s\n\r\t\0\x0b\xa0\xc2]/g,""),""===a},resetContext:function(){this.tokens=[].concat(this.context)},isShortToken:function(a,b){return-1!=this.getOption("nodes.short").indexOf(a.toLowerCase())||b.length<20},isOnlyChild:function(a){return a.parentNode?1==a.parentNode.childNodes.length:!1},hasInlineOrTextSiblings:function(a){if(!a.parentNode)return!1;for(var b=0;b<a.parentNode.childNodes.length;b++){var c=a.parentNode.childNodes[b];if(c!=a&&(this.isInlineNode(c)||this.isValidTextNode(c)))return!0}return!1},isInlineNode:function(a){return 1==a.nodeType&&-1!=this.getOption("nodes.inline").indexOf(a.tagName.toLowerCase())&&!this.isOnlyChild(a)},isContainerNode:function(a){return 1==a.nodeType&&!this.isInlineNode(a)},isSelfClosingNode:function(a){return!a.firstChild},isIgnoredNode:function(a){return 1!=a.nodeType?!0:-1!=this.getOption("nodes.ignored").indexOf(a.tagName.toLowerCase())},isValidTextNode:function(a){return a?3==a.nodeType&&!this.isEmptyString(a.nodeValue):!1},isSeparatorNode:function(a){return a?1==a.nodeType&&-1!=this.getOption("nodes.splitters").indexOf(a.tagName.toLowerCase()):!1},sanitizeValue:function(a){return a.replace(/^\s+/,"")},replaceSpecialCharacters:function(a){if(!this.getOption("data_tokens.special.enabled"))return a;var b=a.match(this.getOption("data_tokens.special.regex")),c=this;return b.forEach(function(b){token=b.substring(1,b.length-2),c.context[token]=b,a=a.replace(b,"{"+token+"}")}),a},generateDataTokens:function(a){var b=this;a=this.sanitizeValue(a);var c=null;if(this.getOption("data_tokens.date.enabled")){c=b.getOption("data_tokens.date.name");var d=b.getOption("data_tokens.date.formats");d.forEach(function(d){var e=d[0],f=(d[1],a.match(e));f&&f.forEach(function(d){var e=d,f=b.contextualize(c,e),g="{"+f+"}";a=a.replace(d,g)})})}var e=this.getOption("data_tokens.rules");return e&&e.forEach(function(c){if(c.enabled){var d=a.match(c.regex);d&&d.forEach(function(d){var e=d.trim();if(""!==e){var f=b.contextualize(c.name,e),g=d.replace(e,"{"+f+"}");a=a.replace(d,g)}})}}),a},generateHtmlToken:function(a,b){var c=a.tagName.toLowerCase(),e=a.attributes,f={};if(b=b?b:"{$0}",0===e.length)return this.isSelfClosingNode(a)?"br"==c||"hr"==c?"<"+c+"/>":"<"+c+"></"+c+">":"<"+c+">"+b+"</"+c+">";for(var g=0;g<e.length;g++)f[e[g].name]=e[g].value;var h=d.keys(f);h.sort();var i=[];return h.forEach(function(a){var b=-1!=f[a].indexOf("'")?'"':"'";i.push(a+"="+b+f[a]+b)}),i=i.join(" "),this.isSelfClosingNode(a)?"<"+c+" "+i+"></"+c+">":"<"+c+" "+i+">"+b+"</"+c+">"},adjustName:function(a){var b=a.tagName.toLowerCase(),c=this.getOption("name_mapping");return b=c[b]?c[b]:b},contextualize:function(a,b){if(this.tokens[a]&&this.tokens[a]!=b){var c=0,d=a.match(/\d+$/);return d&&d.length>0&&(c=parseInt(d[d.length-1]),a=a.replace(""+c,"")),a+=c+1,this.contextualize(a,b)}return this.tokens[a]=b,a},debug:function(a){this.doc=a,this.debugTree(a,0)},debugTree:function(a,b){var c=new Array(b+1).join("=");if(console.log(c+"=> "+typeof a+": "+this.nodeInfo(a)),a.childNodes)for(var d=this,e=0;e<a.childNodes.length;e++){var f=a.childNodes[e];d.debugTree(f,b+1)}},nodeInfo:function(a){var b=[];return b.push(a.nodeType),1==a.nodeType&&b.push(a.tagName),this.isInlineNode(a)&&(b.push("inline"),this.hasInlineOrTextSiblings(a)?b.push("sentence"):b.push("only translatable")),this.isSelfClosingNode(a)&&b.push("self closing"),this.isOnlyChild(a)&&b.push("only child"),3==a.nodeType?"["+b.join(", ")+']: "'+a.nodeValue+'"':"["+b.join(", ")+"]"}},b.exports=f},{"../configuration":17,"../utils":40}],34:[function(a,b,c){var d=a("../utils"),e=(a("../logger"),a("../configuration")),f=a("../decorators/html"),g=function(a,b){a&&(this.full_name=a,this.label=b,this.parseElements())};g.prototype={parseElements:function(){var a=this.full_name.replace(/[%\{\}]/g,"").trim(),b=a.split("::")[0].trim();this.short_name=a.split(":")[0].trim(),this.case_keys=[];for(var c=a.match(/(::\s*\w+)/g)||[],d=0;d<c.length;d++)this.case_keys.push(c[d].replace(/[:]/g,"").trim());for(this.context_keys=[],c=b.match(/(:\s*\w+)/g)||[],d=0;d<c.length;d++)this.context_keys.push(c[d].replace(/[:]/g,"").trim())},getContextForLanguage:function(a){return this.context_keys.length>0?a.getContextByKeyword(this.context_keys[0]):a.getContextByTokenName(this.short_name)},getTokenObject:function(a,b){if(!a)return null;b=b||this.short_name;var c=a[b];return d.isArray(c)?c[0]:c&&c.object||c},error:function(a){return this.full_name},getTokenValueFromArrayParam:function(a,b,c){if(c=c||{},0===a.length)return this.error("Invalid number of params of an array");var e=a[0],f=a.length>1?a[1]:null;return d.isArray(e)?this.getTokenValueFromArray(a,b,c):f&&d.isFunction(f)?this.sanitize(f(e),e,b,d.extend(c,{safe:!0})):f?this.sanitize(f.toString(),e,b,d.extend(c,{safe:!0})):this.sanitize(""+e,e,b,d.extend(c,{safe:!1}))},getTokenValueFromHashParam:function(a,b,c){c=c||{};var e=a.value||a.name||a.first_name||a.username,f=a.method,g=a.object;if(f&&d.isFunction(f))return this.sanitize(f(g),g,b,d.extend(c,{safe:!0}));if(e)return this.sanitize(e,g||a,b,d.extend(c,{safe:!0}));if(!g)return this.sanitize(a.toString(),g,b,d.extend(c,{safe:!1}));var h=a.attribute;return h?this.sanitize(g[h],g,b,d.extend(c,{safe:!1})):this.error("Missing value for hash token")},getTokenValueFromArray:function(a,b,c){var e={description:"List joiner",limit:4,separator:", ",joiner:"and",less:"{laquo} less",expandable:!1,collapsable:!0};c=c||{};var g=a[0],h=a.length>1?a[1]:null;a.length>2&&(e=d.extend(e,a[2])),c.skip_decorations&&(e.expandable=!1);for(var i=[],j=0;j<g.length;j++){var k=g[j];if(null===h)i.push(f.decorateElement(this,this.getTokenValueFromHashParam(k,b,c),c));else if(d.isFunction(h))i.push(f.decorateElement(this,this.sanitize(h(k),k,b,d.extend(c,{safe:!0})),c));else if("string"==typeof h)if(h.match(/^@/)){var l=h.replace(/^@/,"");i.push(f.decorateElement(this,this.sanitize(k[l]||k[l](),k,b,d.extend(c,{safe:!1})),c))}else i.push(f.decorateElement(this,h.replace("{$0}",this.sanitize(""+k,k,b,d.extend(c,{safe:!1}))),c));else if(d.isObject(h)){var m=h.attribute||h.property;m&&k[m]?(m=this.sanitize(k[m],k,b,d.extend(c,{safe:!1})),h.value?i.push(f.decorateElement(this,h.value.replace("{$0}",m),c)):i.push(f.decorateElement(this,m||""+k,c))):i.push(f.decorateElement(this,this.getTokenValueFromHashParam(k,b,c),c))}}if(1==i.length)return i[0];if(!e.joiner||""===e.joiner)return i.join(e.separator);var n=c.target_language||b,o=n.translate(e.joiner,e.description,{},c);if(i.length<=e.limit){var p=i.pop();return i.join(e.separator)+" "+o+" "+p}var q=i.slice(0,e.limit),r=i.slice(e.limit),s=q.join(e.separator),t=n.translate("{count || other}",e.description,{count:r.length},c);if(!e.expandable)return s=s+" "+o+" ",d.isFunction(e)?s+e.remainder(r):s+t;var u=e.key?e.key:d.generateKey(this.label,i.join(","));s=s+'<span id="tml_other_link_'+u+'"> '+o+" ",s=s+'<a href="#" class="tml_other_list_link" onClick="document.getElementById(\'tml_other_link_'+u+"').style.display='none'; document.getElementById('tml_other_elements_"+u+"').style.display='inline'; return false;\">",s+=e.remainder&&"function"==typeof e.remainder?e.remainder(r):t,s+="</a></span>",s=s+'<span id="tml_other_elements_'+u+'" style="display:none">'+e.separator;var v=r.pop();return s+=r.join(e.separator),s=s+" "+o+" "+v,e.collapsable&&(s=s+' <a href="#" class="tml_other_less_link" style="font-size:smaller;white-space:nowrap" onClick="document.getElementById(\'tml_other_link_'+u+"').style.display='inline'; document.getElementById('tml_other_elements_"+u+"').style.display='none'; return false;\">",s+=n.translate(e.less,e.description,{},c),s+="</a>"),s+="</span>"},getTokenValue:function(a,b,c){a=a||{},c=c||{};var f=this.short_name in a,g=f?a[this.short_name]:e.getDefaultToken(this.short_name);return"undefined"==typeof g||null===g?this.error("Missing token value"):"string"==typeof g?this.sanitize(g.toString(),g,b,d.extend(c,{safe:!0})):d.isArray(g)?this.getTokenValueFromArrayParam(g,b,c):d.isObject(g)?this.getTokenValueFromHashParam(g,b,c):this.sanitize(g.toString(),g,b,d.extend(c,{safe:!1}))},applyCase:function(a,b,c,d,e){var f=d.getLanguageCaseByKeyword(a);return f?f.apply(b,c,e):b},sanitize:function(a,b,c,e){if(e=e||{},a=""+a,e.safe||(a=d.escapeHTML(a)),this.case_keys.length>0)for(var f=0;f<this.case_keys.length;f++)a=this.applyCase(this.case_keys[f],a,b,c,e);return a},substitute:function(a,b,c,d){return a.replace(this.full_name,f.decorateToken(this,this.getTokenValue(b,c,d),d))},getDecorationName:function(){return"data"}},b.exports=g},{"../configuration":17,"../decorators/html":18,"../logger":25,"../utils":40}],35:[function(a,b,c){var d=a("../utils"),e=a("../decorators/html"),f=a("./data"),g=function(a,b){a&&(this.full_name=a,this.label=b,this.parseElements(),this.initObject())};g.prototype=new f,g.prototype.constructor=g,g.prototype.initObject=function(){var a=this.short_name.split(".");this.short_name=a[0],this.object_method=a[1]},g.prototype.getTokenValue=function(a,b,c){a=a||{};var e=a[this.short_name];if(!e)return this.error("Missing token value");var f;return f=d.isFunction(e[this.object_method])?e[this.object_method]():e[this.object_method]},g.prototype.substitute=function(a,b,c,f){return a.replace(this.full_name,e.decorateToken(this,this.sanitize(this.getTokenValue(b),this.getTokenObject(b),c,d.extend(f,{safe:!1})),f))},g.prototype.getDecorationName=function(){return"method"},b.exports=g},{"../decorators/html":18,"../utils":40,"./data":34}],36:[function(a,b,c){var d=a("../utils"),e=a("../decorators/html"),f=a("./data"),g=function(a,b){a&&(this.full_name=a,this.label=b,this.parseElements())};g.prototype=new f,g.prototype.constructor=g,g.prototype.parseElements=function(){var a=this.full_name.replace(/[%\{\}]/g,"").trim(),b=a.split("|"),c=b[0].trim();this.short_name=c.split(":")[0].trim(),this.case_keys=[];for(var d=c.match(/(::\s*\w+)/g)||[],e=0;e<d.length;e++)this.case_keys.push(d[e].replace(/[:]/g,"").trim());this.context_keys=[];var f=c.split("::")[0].trim();for(d=f.match(/(:\s*\w+)/g)||[],e=0;e<d.length;e++)this.context_keys.push(d[e].replace(/[:]/g,"").trim());if(this.separator=-1!=this.full_name.indexOf("||")?"||":"|",this.parameters=[],b=a.split(this.separator),b.length>1)for(b=b[1].split(","),e=0;e<b.length;e++)this.parameters.push(b[e].trim())},g.prototype.isValueDisplayedInTranslation=function(){return"||"==this.separator},g.prototype.generateValueMapForContext=function(a){var b,c,e={};if(-1!=this.parameters[0].indexOf(":")){for(b=0;b<this.parameters.length;b++){var f=this.parameters[b].split(":");e[f[0].trim()]=f[1].trim()}return e}var g=a.token_mapping;if(!g)return this.error("The token context "+a.keyword+"does not support transformation for unnamed params"),null;if("string"==typeof g)return this.error("The token mapping "+g+" does not support the parameters."),null;if(d.isArray(g)){if(this.parameters.length>g.length)return this.error("The token mapping "+g+" does not support "+this.parameters.length+" parameters"),null;if(g=g[this.parameters.length-1],"string"==typeof g)return this.error("The token mapping "+g+" does not support "+this.parameters.length+" parameters"),null}var h=d.keys(g);for(b=0;b<h.length;b++){var i=h[b],j=g[i];e[i]=j;var k=j.match(/{\$\d(::[\w]+)*\}/g)||[];for(c=0;c<k.length;c++){var l=k[c],m=l.replace(/[\{\}]/g,""),n=m.split("::"),o=parseInt(n[0].replace(/[$]/,""));if(this.parameters.length<o)return this.error("The index inside "+g+" is out of bound: "+this.full_name),null;var p=this.parameters[o];n.shift();for(var q=0;q<n.length;q++){var r=a.language.getLanguageCaseByKeyword(n[q]);r&&(p=r.apply(p))}e[i]=e[i].replace(k[c],p)}}return e},g.prototype.substitute=function(a,b,c,d){if(!(this.short_name in b))return this.error("Missing value"),a;var f=this.getTokenObject(b);if(0===this.parameters.length)return this.error("Piped params may not be empty"),a;var g=this.getContextForLanguage(c),h=this.generateValueMapForContext(g);if(!h)return a;var i=g.findMatchingRule(f);if(null===i)return a;var j=h[i.keyword];if(!j){var k=g.getFallbackRule();if(!k||!h[k.keyword])return this.error("No matching context rule found and no fallback provided"),a;j=h[k.keyword]}var l=[],m=e.decorateToken(this,this.getTokenValue(b,c,d),d);return this.isValueDisplayedInTranslation()?(l.push(m),l.push(" ")):j=j.replace("#"+this.short_name+"#",m),l.push(j),a.replace(this.full_name,l.join(""))},g.prototype.getDecorationName=function(){return"piped"},b.exports=g},{"../decorators/html":18,"../utils":40,"./data":34}],37:[function(a,b,c){var d=a("./utils"),e=a("./tokens/data"),f=function(a){d.extend(this,a),a.language&&(this.locale=a.language.locale)};f.prototype={hasContextRules:function(){return this.context&&d.keys(this.context).length>0},isValidTranslation:function(a){if(!this.hasContextRules())return!0;for(var b=d.keys(this.context),c=0;c<b.length;c++){var f=b[c],g=this.context[f],h=e.prototype.getTokenObject(a,f);if(!h)return!1;for(var i=d.keys(g),j=0;j<i.length;j++){var k=i[j],l=g[i[j]];if("other"!=l){var m=this.language.getContextByKeyword(k);if(!m)return!1;var n=m.findMatchingRule(h);if(!n||n.keyword!=l)return!1}}}return!0}},b.exports=f},{"./tokens/data":34,"./utils":40}],38:[function(a,b,c){var d=a("./utils"),e=a("./configuration"),f=a("./translation"),g=a("./decorators/html"),h=a("./tokenizers/data"),i=a("./tokenizers/decoration"),j=function(a){d.extend(this,a),this.key=this.key||d.generateKey(this.label,this.description),!this.locale&&this.application&&(this.locale=this.application.default_locale),!this.language&&this.application&&(this.language=this.application.getLanguage(this.locale)),this.translations={},this.addTranslations(a.translations||{})};j.prototype={addTranslations:function(a){for(var b=d.keys(a),c=0;c<b.length;c++)for(var e=b[c],g=a[e],h=0;h<g.length;h++){var i=g[h];this.addTranslation(new f(d.extend(i,{language:this.application.getLanguage(i.locale),translation_key:this})))}},addTranslation:function(a){var b=this.translations[a.locale];b||(b=[]),b.push(a),this.translations[a.locale]=b},setTranslations:function(a,b){this.translations[a]=[];for(var c=0;c<b.length;c++){var d=b[c];d.translation_key=this,d.language=this.application.getLanguage(d.locale),this.translations[a].push(d)}},resetTranslations:function(){this.translations={}},getTranslationsForLanguage:function(a){return this.translations?this.translations[a.locale]||[]:[]},findFirstValidTranslation:function(a,b){for(var c=this.getTranslationsForLanguage(a),d=0;d<c.length;d++)if(c[d].isValidTranslation(b))return c[d];return null},translate:function(a,b,c){if(c=c||{},e.isDisabled())return this.substituteTokens(this.label,b,a,c);var d=this.findFirstValidTranslation(a,b),f=g;return d?(c.locked=d.locked,f.decorate(this.substituteTokens(d.label,b,d.language,c),d.language,a,this,c)):(c.target_language=a,f.decorate(this.substituteTokens(this.label,b,this.language||a,c),this.language||a,a,this,c))},getDataTokens:function(){if(!this.data_tokens){var a=new h(this.label);this.data_tokens=a.tokens}return this.data_tokens},getDataTokenNames:function(){if(!this.data_token_names){this.data_token_names=[];for(var a in this.getDataTokens())this.data_token_names.push(a.full_name)}return this.data_token_names},getDecorationTokenNames:function(){if(!this.decoration_tokens){var a=new i(this.label);a.parse(),this.decoration_tokens=a.tokens}return this.decoration_tokens},substituteTokens:function(a,b,c,e){var f;return(-1!=a.indexOf("[")||-1!=a.indexOf("<"))&&(f=new i(a),a=f.substitute(b,d.extend(e,{allowed_tokens:this.getDecorationTokenNames()}))),-1!=a.indexOf("{")&&(f=new h(a),a=f.substitute(c,b,d.extend(e,{allowed_tokens:this.getDataTokenNames()}))),a}},b.exports=j},{"./configuration":17,"./decorators/html":18,"./tokenizers/data":31,"./tokenizers/decoration":32,"./translation":37,"./utils":40}],39:[function(a,b,c){var d=a("./utils"),e=function(a){d.extend(this,a)};e.prototype={isFeatureEnabled:function(a){return this.features&&this.features[a]}},b.exports=e},{"./utils":40}],40:[function(a,b,c){(function(c){var d=a("./md5");b.exports={hashValue:function(a,b,c){c=c||null;for(var d=b.split("."),e=0;e<d.length;e++){var f=d[e];if("undefined"==typeof a[f])return c;a=a[f]}return a},stripTags:function(a,b){b=(((b||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");var c=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,d=/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi;return a.replace(d,"").replace(c,function(a,c){return b.indexOf("<"+c.toLowerCase()+">")>-1?a:""})},escapeHtml:function(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},sanitizeString:function(a){return a?a.replace(/^\s+|\s+$/g,""):""},splitSentences:function(a){var b=/[^.!?\s][^.!?]*(?:[.!?](?![\'"]?\s|$)[^.!?]*)*[.!?]?[\'"]?(?=\s|$)/g;return a.match(b)},unique:function(a){return a.reverse().filter(function(a,b,c){return-1===c.indexOf(a,b+1)}).reverse()},clone:function(a){if(null===a||"undefined"==typeof a||"object"!=typeof a)return a;var b=a.constructor();for(var c in a)b[c]=clone(a[c]);return b},keys:function(a){return Object.keys(a)},generateSourceKey:function(a){return d(a)},generateKey:function(a,b){return b=b||"",d(a+";;;"+b)},escapeHTML:function(a){return a.replace(/[&<>]/g,function(a){return{"&":"&amp;","<":"&lt;",">":"&gt;"}[a]||a})},encode:function(a){if(!a)return null;var b=JSON.stringify(a);return b=new c(b,"utf-8").toString("base64"),b=encodeURIComponent(b),b=encodeURIComponent(b)},decode:function(a){if(!a)return null;a=decodeURIComponent(a),a=decodeURIComponent(a);var b=new c(a,"base64").toString("utf-8");return JSON.parse(b)},normalizeSource:function(a){var b=a.split("?");return b[0]},normalizeParams:function(a,b,c,d){return"object"==typeof a?a:("string"!=typeof b&&(d=c||{},c=b||{},b=""),d=d||{},{label:a,description:b,tokens:c,options:d})},normalizePath:function(a){return("/"==a[0]?"":"/")+a},assign:function(a,b,c){for(var d in b)hasOwnProperty.call(b,d)&&(c&&d in a&&"object"==typeof a[d]&&"object"==typeof b[d]?this.assign(a[d],b[d],c):a[d]=b[d]);return a},extend:function(a){for(var b=1;b<arguments.length;b++)a=this.assign(a,arguments[b]);return a},merge:function(a){for(var b=1;b<arguments.length;b++)a=this.assign(a,arguments[b],!0);return a},addCSS:function(a,b,c){var d=null;return c?(d=a.createElement("style"),d.type="text/css",d.styleSheet?d.styleSheet.cssText=b:d.appendChild(document.createTextNode(b))):(d=a.createElement("link"),d.setAttribute("type","text/css"),d.setAttribute("rel","stylesheet"),d.setAttribute("media","screen"),d.setAttribute("href",b)),a.getElementsByTagName("head")[0].appendChild(d),d},addJS:function(a,b,c,d){var e=a.createElement("script");return e.setAttribute("id",b),e.setAttribute("type","application/javascript"),e.setAttribute("src",c),e.setAttribute("charset","UTF-8"),d&&(e.onload=d),a.getElementsByTagName("head")[0].appendChild(e),e},getCookieName:function(a){return"trex_"+a},getCookie:function(a){for(var b=this.getCookieName(a),c=b+"=",d=document.cookie.split(";"),e=0;e<d.length;e++){for(var f=d[e];" "==f.charAt(0);)f=f.substring(1);if(-1!=f.indexOf(c))return f.substring(c.length,f.length)}return""},setCookie:function(a,b){var c=this.getCookieName(a);document.cookie=c+"="+b+"; path=/"},templateCache:{},template:function(a,b){var c=this.templateCache,d=/\W/.test(a)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+a.replace(/[\r\t\n]/g," ").split("<%").join("	").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("	").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):c[a]=c[a]||this.template(document.getElementById(a).innerHTML);return b?d(b):d},element:function(a){return"string"==typeof a?document.getElementById(a):a},isNumber:function(a){return-1!=a.search(/^\s*\d+\s*$/)},isArray:function(a){return null===a||"undefined"==typeof a?!1:-1!==a.constructor.toString().indexOf("Array")},isObject:function(a){return null===a||"undefined"==typeof a?!1:"object"==typeof a},isFunction:function(a){return"function"==typeof a},isString:function(a){return"string"==typeof a},isURL:function(a){return a=""+a,-1!=a.indexOf("http://")||-1!=a.indexOf("https://")},toQueryParams:function(a){if("undefined"==typeof a||null===a)return"";if("string"==typeof a)return a;var b=[];for(var c in a)b.push(c+"="+encodeURIComponent(a[c]));return b.join("&")},parallel:function(a,b){var c,d=0,e=0,f={},g=function(c){a[c](function(a,g){a&&b(a),g&&(f[c]=g),e++,e==d&&b(null,f)})};for(c in a)d++;d||b(null,f);for(c in a)g(c)},localizeDate:function(a,b){return a}}}).call(this,a("buffer").Buffer)},{"./md5":26,buffer:7}]},{},[5]);